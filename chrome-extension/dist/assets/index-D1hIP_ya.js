var Wt=Object.defineProperty;var Ft=(r,e,t)=>e in r?Wt(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var $e=(r,e,t)=>(Ft(r,typeof e!="symbol"?e+"":e,t),t);import{an as Yt,ao as Gt,ap as Ve,z as F,A as m,B as Y,C as g,aq as Jt,w as ke,S as z,f as U,s as V,g as E,j as c,m as k,Y as ue,M as Z,n as C,r as b,N as pe,a1 as Ce,H as X,I as He,k as H,J as Se,K as Re,L as Ne,V as Dt,u as L,h as D,o as $,a2 as je,R as I,T as P,U as M,t as J,ar as Qt,as as Xt,at as xt,au as en,av as tn,aw as nn,ax as ln,ay as rn,az as sn,aA as on,aB as un,af as an,aC as fn,aD as cn,aE as dn,aF as pn,aG as hn,aH as gn,aI as mn,b as _n,q as $n,aJ as kn,aK as bn,aL as wn,aM as vn,aN as Cn,aO as yn,aP as Ln,aQ as In,aR as Pn,y as Ee,D as Q,F as oe,G as at,O as Ze,p as ye,P as ge,Z as Mn,_ as En,a5 as At,a3 as Ht,a4 as St,a9 as ee,v as de,x as Xe,am as Rt,Q as ne,a7 as Nt,a8 as zt,$ as Ge,a0 as Je,aa as De,ah as On}from"./index-Cqd5pjsu.js";function ft(r,e){const t=e.token={};function n(l,s,o,i){if(e.token!==t)return;e.resolved=i;let u=e.ctx;o!==void 0&&(u=u.slice(),u[o]=i);const f=l&&(e.current=l)(u);let a=!1;e.block&&(e.blocks?e.blocks.forEach((p,d)=>{d!==s&&p&&(F(),m(p,1,1,()=>{e.blocks[d]===p&&(e.blocks[d]=null)}),Y())}):e.block.d(1),f.c(),g(f,1),f.m(e.mount(),e.anchor),a=!0),e.block=f,e.blocks&&(e.blocks[s]=f),a&&Jt()}if(Yt(r)){const l=Gt();if(r.then(s=>{Ve(l),n(e.then,1,e.value,s),Ve(null)},s=>{if(Ve(l),n(e.catch,2,e.error,s),Ve(null),!e.hasCatch)throw s}),e.current!==e.pending)return n(e.pending,0),!0}else{if(e.current!==e.then)return n(e.then,1,e.value,r),!0;e.resolved=r}}function Tn(r,e,t){const n=e.slice(),{resolved:l}=r;r.current===r.then&&(n[r.value]=l),r.current===r.catch&&(n[r.error]=l),r.block.p(n,t)}function qe(r){let e=r.month,t=r.day,n=r.year,l=e!=null&&e.length!=0&&!isNaN(parseInt(e))&&parseInt(e)>=1&&parseInt(e)<=12&&e.length<=2&&e.length>=1,s=t!=null&&t.length!=0&&!isNaN(parseInt(t))&&parseInt(t)>=1&&parseInt(t)<=31&&t.length<=2&&t.length>=1,o=n!=null&&n.length!=0&&!isNaN(parseInt(n))&&n.length>2;return{month:l,day:s,year:o}}function Ke(r){return r!=null&&r.length!=0}function Dn(r){return r.length>0&&r[0].name.length>0}let le={bigAuthors:{key:"authors",format:function(r){let e=null;if(r.authors.length>0&&r.authors.filter(t=>t.name.length>0).length>0){const t=r.authors[0];t.isPerson?e=t.name.split(" ").pop()??null:e=`${t.name}`}return e}},bigDate:{key:"date",format:function(r){let e=null,t=qe(r.date);return t.month&&t.day&&t.year?new Date(parseInt(r.date.year),parseInt(r.date.month)-1,parseInt(r.date.day)).getFullYear():e}},date:{key:"date",format:function(r){let e=null,t=qe(r.date);if(!(t.month&&t.day&&t.year))return e;const n=new Date(parseInt(r.date.year),parseInt(r.date.month)-1,parseInt(r.date.day));return e=n.getDate()+" "+n.toLocaleString("en-us",{month:"short"})+" "+n.getFullYear(),e}},accessDate:{key:"accessDate",format:function(r){let e=null,t=qe(r.accessDate);if(!(t.month&&t.day&&t.year))return e;const n=new Date(parseInt(r.accessDate.year),parseInt(r.accessDate.month)-1,parseInt(r.accessDate.day));return n instanceof Date&&!isNaN(n.valueOf())&&(e="Accessed "+n.getDate()+" "+n.toLocaleString("en-us",{month:"short"})+" "+n.getFullYear()),e}},authors:{key:"authors",format:function(r){let e=null;return r.authors.length>0&&r.authors.filter(t=>t.name.length>0).length>0&&(e=r.authors.map(t=>t.name).join(", ")),e}},title:{key:"title",format:function(r){let e=null;return Ke(r.title)&&(e=r.title),e}},siteName:{key:"siteName",format:function(r){let e=null;return Ke(r.siteName)&&(e=r.siteName),e}},url:{key:"url",format:function(r){let e=null;return Ke(r.url)&&(e=r.url),e}}};function Ut(r,e,t=!0,n=!0){let l=document.createElement("div");if(t){let s=document.createElement("h3");s.textContent=r.tag,n&&(s.style.fontFamily="Calibri"),s.style.fontSize="13pt",s.style.margin="0px",l.appendChild(s);let o=document.createElement("p");n&&(o.style.fontFamily="Calibri"),o.style.margin="0px";let i=document.createElement("span");i.textContent=`${le.bigAuthors.format(r)}, ${le.bigDate.format(r)} `,i.style.fontSize="13pt",i.style.fontWeight="bold",o.appendChild(i);let u=document.createElement("span");u.textContent=`[${le.authors.format(r)}. ${le.date.format(r)}. "${le.title.format(r)}". ${le.siteName.format(r)}. ${le.url.format(r)}. ${le.accessDate.format(r)}]`,u.style.fontSize="11pt",o.appendChild(u),l.appendChild(o)}for(let s of r.paras){let o=document.createElement("p");n&&(o.style.fontFamily="Calibri"),o.style.fontSize="11pt",o.style.margin="0.8em 0",o.style.lineHeight="1.15em";for(let i of s){let u=document.createElement("span");u.innerText=i.text,i.underline&&(u.style.textDecoration="underline"),!i.underline&&e&&(u.style.fontSize="8pt"),i.highlight&&(u.style.backgroundColor="yellow"),o.appendChild(u)}l.appendChild(o)}return l}function An(r,e=!1){let t=Ut(r,e);Hn(t)}function Hn(r){let e=new Blob([r.innerHTML],{type:"text/html"});for(let l of r.children)l.appendChild(document.createTextNode(`
`));let t=new Blob([r.textContent??""],{type:"text/plain"});const n=new window.ClipboardItem({"text/html":e,"text/plain":t});navigator.clipboard.write([n])}let Ae=ke({open:!1,claimed:!1}),Pe=ke([]);class Sn{constructor(){$e(this,"messages");$e(this,"timeouts");this.messages=ke([]),this.timeouts=[]}addMessage(e){this._addMessage(e,!1)}addErrorMessage(e){this._addMessage(e,!0)}addError(e,t){let n;if(t==null)n=`Unknown ${e} error`;else{let l=e.charAt(0).toUpperCase()+e.slice(1),s=t.toString();s.length>100&&(console.log(s),s=s.slice(0,100)+"..."),n=`${l} error: ${t}`}this._addMessage(n,!0)}_addMessage(e,t){this.messages.update(n=>(n.push({text:e,id:Date.now(),error:t}),n.length>3&&(n.shift(),clearTimeout(this.timeouts.shift())),this.timeouts.push(setTimeout(()=>{this.messages.update(l=>(l.shift(),l)),this.timeouts.shift()},5e3)),n))}}let W=new Sn,Rn=W.messages;function Nn(r){return JSON.parse(JSON.stringify(r))}let ct={text:" text edit",addAuthor:" author addition",deleteAuthor:" author deletion",editAuthor:" author edit",editDate:" date edit",editPara:" paragraph edit",condenseParas:" paragraph condensation",autoCutParas:" auto-cut"};class zn{constructor(e){$e(this,"history");$e(this,"card");$e(this,"$card");$e(this,"authorIdCounter");$e(this,"pos");this.history=[],this.card=e,this.$card,this.pos=0,this.card.subscribe(t=>{var n,l;this.$card=t,this.authorIdCounter==null&&(this.authorIdCounter=((l=(n=this.$card)==null?void 0:n.authors)==null?void 0:l.length)-1)}),this.authorIdCounter=null}doAction(e,t){let n;switch(e){case"text":n={key:t.key,oldText:this.$card[t.key]},this.$card[t.key]=t.text;break;case"addAuthor":n={},this.authorIdCounter+=1,this.$card.authors.push({name:"",isPerson:!0,description:null,id:this.authorIdCounter});break;case"deleteAuthor":n={deletedAuthor:{...this.$card.authors[t.index]}},this.$card.authors.splice(t.index,1);break;case"editAuthor":n={index:t.index,oldAuthor:{...this.$card.authors[t.index]}},this.$card.authors[t.index]=t.author;break;case"editDate":n={key:t.key,oldDate:{...this.$card[t.key]}},this.$card[t.key]=t.date;break;case"editPara":n=this.editParas(t);break;case"condenseParas":n=this.condenseParas();break;case"autoCutParas":n={oldParas:Nn(this.$card.paras)},this.$card.paras=t}return n}action(e,t){let n=this.doAction(e,t);if(this.card.set(this.$card),this.history.push({name:e,undoData:n,redoData:t,canExtend:!0}),this.history.length>=2){let l=this.history[this.history.length-2];if(l.canExtend&&l.name==e)switch(e){case"text":this.history.pop();break;case"editAuthor":this.history.pop();break;case"editDate":this.history.pop();default:l.canExtend=!1}}this.pos!=0&&(this.history.splice(this.history.length-this.pos),this.pos=0)}preventExtension(){this.history.length>0&&(this.history[this.history.length-1].canExtend=!1)}undo(){if(this.history.length==0)return;if(this.pos+=1,this.pos>this.history.length){this.pos=this.history.length;return}let e=this.history[this.history.length-this.pos],t=e.undoData;switch(e.name){case"text":this.$card[t.key]=t.oldText;break;case"addAuthor":this.$card.authors.pop();break;case"deleteAuthor":this.$card.authors.splice(t.index,0,t.deletedAuthor);break;case"editAuthor":this.$card.authors[t.index]={...t.oldAuthor};break;case"editDate":this.$card[t.key]=t.oldDate;break;case"editPara":this.uneditParas(t);break;case"condenseParas":this.uncondenseParas(t);break;case"autoCutParas":this.$card.paras=t.oldParas;break}W.addMessage("Undid "+ct[e.name]),this.card.set(this.$card)}redo(){if(this.history.length==0)return;let e=this.history[this.history.length-this.pos];if(this.pos-=1,this.pos<0){this.pos=0;return}let t=e.redoData;this.doAction(e.name,t),W.addMessage("Redid "+ct[e.name]),this.card.set(this.$card)}getChangeRunIndexes(e,t){const n=t.startP,l=t.endP,s=t.startSpan;let o=t.endSpan;const i=t.startOffset,u=t.endOffset;let f=[];if(n==l&&s==o){let a=e[n][s],p={...a},d={...a},h={...a};p.text=a.text.slice(0,i),d.text=a.text.slice(i,u),h.text=a.text.slice(u),f.push([n,s+1]),e[n]=[...e[n].slice(0,s),p,d,h,...e[n].slice(s+1)]}else{let a=e[n][s],p={...a},d={...a};p.text=a.text.slice(0,i),d.text=a.text.slice(i),f.push([n,s+1]),e[n]=[...e[n].slice(0,s),p,d,...e[n].slice(s+1)],n==l&&(o+=1);for(let h=n;h<l+1;h++)for(let _=0;_<e[h].length;_++)h==n&&_<s+2||h==l&&_>o-1||f.push([h,_]);a=e[l][o],p={...a},d={...a},p.text=a.text.slice(0,u),d.text=a.text.slice(u),f.push([l,o]),e[l]=[...e[l].slice(0,o),p,d,...e[l].slice(o+1)],o+=1}return f}editParas(e){let t=e.tool,n=[...this.$card.paras],l=this.getChangeRunIndexes(n,e.index),s=!0;for(let[i,u]of l)n[i][u][t]||(s=!1);let o=[];for(let[i,u]of l){let f=0;for(let a=0;a<u;a++)f+=n[i][a].text.length;o.push({format:{highlight:n[i][u].highlight,underline:n[i][u].underline},paraIndex:i,startOffset:f,endOffset:f+n[i][u].text.length}),t=="eraser"?(n[i][u].underline=!1,n[i][u].highlight=!1):s?n[i][u][t]=!1:n[i][u][t]=!0}return this.$card.paras=n,this.combineRuns(),{changedRuns:o}}uneditParas(e){let t=[...this.$card.paras];for(let n of e.changedRuns){let l=n.paraIndex,s=t[l],o=0,i=n.startOffset;for(;i>s[o].text.length;)i-=s[o].text.length,o+=1;let u=0,f=n.endOffset;for(;f>s[u].text.length;)f-=s[u].text.length,u+=1;let a={startP:l,endP:l,startSpan:o,endSpan:u,startOffset:i,endOffset:f},p=this.getChangeRunIndexes(t,a);for(let[d,h]of p)t[d][h].underline=n.format.underline,t[d][h].highlight=n.format.highlight}this.$card.paras=t,this.combineRuns()}combineRuns(){this.$card.paras=this.$card.paras.map(function(e){let t=[];if(e.length==0)return[];let n={...e[0]};for(let l=1;l<e.length;l++){let s=e[l];s.text.length!=0&&(s.highlight==n.highlight&&s.underline==n.underline?n.text=n.text.concat(s.text):(t.push({...n}),n={...s}))}return t.push({...n}),t})}condenseParas(){let e=[],t=0,n=[];for(let l of this.$card.paras)if(l.length>0){l[l.length-1].text+=" ";let s=l.reduce(function(o,i){return o+i.text.length},0);t+=s,n.push(t),e=[...e,...l]}return this.$card.paras=[e],this.combineRuns(),{chopPoints:n}}uncondenseParas(e){if(this.$card.paras.length>1)return;let t=[],n=0,l=e.chopPoints,s=0;for(let u of this.$card.paras[0])for(n+=u.text.length,t.push(u);l[s]<n;){let f=l[s],a=t[t.length-1],p={...a},d={...a};p.text=p.text.slice(0,f-n),d.text=d.text.slice(f-n),t[t.length-1]={...p},t.push({...d}),s+=1}let o=[],i=[];n=0,l=e.chopPoints,s=0;for(let u of t)n+=u.text.length,i.push(u),l[s]==n&&(i[i.length-1].text=i[i.length-1].text.slice(0,i[i.length-1].text.length-1),o.push(i),s+=1,i=[]);this.$card.paras=o}}function Un(r){let e,t,n;return{c(){e=E("textarea"),c(e,"style",`${r[4]}px; width: ${r[5]}px;`),c(e,"placeholder",r[1]),c(e,"class","svelte-109byin")},m(l,s){k(l,e,s),ue(e,r[0]),r[8](e),t||(n=[Z(e,"input",r[7]),Z(e,"input",r[2])],t=!0)},p(l,[s]){s&2&&c(e,"placeholder",l[1]),s&1&&ue(e,l[0])},i:C,o:C,d(l){l&&b(e),r[8](null),t=!1,pe(n)}}}function Vn(r,e,t){let{text:n}=e,{placeholder:l=""}=e,{autofocus:s=!1}=e,o,i,u;function f(){o&&(t(3,o.value=o.value.replace(/\r?\n|\r/g,""),o),t(3,o.style.height="0px",o),t(3,o.style.height=o.scrollHeight+"px",o))}Ce(function(){f(),s&&o.focus()});function a(){n=this.value,t(0,n)}function p(d){X[d?"unshift":"push"](()=>{o=d,t(3,o)})}return r.$$set=d=>{"text"in d&&t(0,n=d.text),"placeholder"in d&&t(1,l=d.placeholder),"autofocus"in d&&t(6,s=d.autofocus)},[n,l,f,o,i,u,s,a,p]}let Zn=class extends z{constructor(e){super(),U(this,e,Vn,Un,V,{text:0,placeholder:1,autofocus:6,autoHeight:2})}get autoHeight(){return this.$$.ctx[2]}},Oe=ke({loggedIn:!1}),Vt=!1;chrome.storage.local.get(["loggedIn"],r=>{Oe.set({loggedIn:r.loggedIn}),Vt=!0});Oe.subscribe(r=>{Vt&&chrome.storage.local.set({loggedIn:r.loggedIn})});const qn="https://vault.arguflow.ai/",Kn=qn+"user/",ze="https://api.arguflow.ai/api/",xe=ze+"auth",jn=ze+"card/cut",Bn=ze+"card",Wn=ze+"user/collections/",Fn=ze+"card_collection/";function Le(r,e,t,n=200,l=!0,s={}){return new Promise((o,i)=>{let u={method:e,headers:{"Content-Type":"application/json"}};e!=="GET"&&(u.body=JSON.stringify(t)),fetch(r,u).then(f=>{var a,p;f.ok&&f.status===n?l?f.json().then(d=>{var h;(h=s.onSuccess)==null||h.call(s,d),o(d)}).catch(d=>{var h;(h=s.onError)==null||h.call(s,d),i(d)}):((a=s.onSuccess)==null||a.call(s,f),o(f)):(f.status===401&&Oe.set({loggedIn:!1}),(p=s.onError)==null||p.call(s,f),i("Unauthorized"))}).catch(f=>{var a;(a=s.onError)==null||a.call(s,f),i(f)})})}function Yn(r,e,t=!0){return Le(xe,"POST",{email:r,password:e},204,!1,{onSuccess:()=>{Oe.set({loggedIn:!0}),t&&chrome.storage.local.set({arguflowLogin:{email:r,password:e}})}})}function Gn(){return Le(xe,"DELETE",{},204,!1,{onSuccess:()=>{Oe.set({loggedIn:!1})}})}function Jn(r){return Le(jn,"POST",{uncut_card:r},200,!0)}function Zt(){return Le(xe,"GET",{},200,!0)}function Qn(){return new Promise((r,e)=>{Zt().then(t=>{r(t.id)}).catch(t=>{e(t)})})}function Xn(r){r=xn(r);let e=document.createElement("div");e.innerHTML=r;let t=[];for(let n of e.querySelectorAll("p")){let l=[];l.push(...qt(n)),t.push(l)}return t}function xn(r){return r=r.replace(/\n/g," "),r}function qt(r,e={underline:!1,highlight:!1}){let t=[];if(r instanceof Text)t.push({text:r.textContent,...e});else if(r instanceof HTMLElement){(r.style.textDecoration==="underline"||r.tagName==="U")&&(e.underline=!0),(r.style.fontWeight==="bold"||r.tagName==="B")&&(e.highlight=!0);for(let n of r.childNodes)t.push(...qt(n,{...e}))}return t}function el(r,e,t){return Le(Bn,"POST",{link:e,card_html:r,private:t},200,!0)}async function dt(r){try{const e=await Zt();return await Le(Wn+e.id+"/"+r.toString(),"GET",{},200,!0)}catch(e){return await Promise.reject(e)}}function tl(r,e){return Le(Fn+e,"POST",{card_metadata_id:r},204,!1)}function nl(r){let e,t,n,l;const s=r[3].default,o=He(s,r,r[2],null);return{c(){e=E("button"),o&&o.c(),e.disabled=r[1],c(e,"class","svelte-15ycvct"),H(e,"expand",r[0])},m(i,u){k(i,e,u),o&&o.m(e,null),t=!0,n||(l=Z(e,"click",r[4]),n=!0)},p(i,[u]){o&&o.p&&(!t||u&4)&&Se(o,s,i,i[2],t?Ne(s,i[2],u,null):Re(i[2]),null),(!t||u&2)&&(e.disabled=i[1]),(!t||u&1)&&H(e,"expand",i[0])},i(i){t||(g(o,i),t=!0)},o(i){m(o,i),t=!1},d(i){i&&b(e),o&&o.d(i),n=!1,l()}}}function ll(r,e,t){let{$$slots:n={},$$scope:l}=e,{expand:s=!1}=e,{disabled:o=!1}=e;function i(u){Dt.call(this,r,u)}return r.$$set=u=>{"expand"in u&&t(0,s=u.expand),"disabled"in u&&t(1,o=u.disabled),"$$scope"in u&&t(2,l=u.$$scope)},[s,o,l,n,i]}class ve extends z{constructor(e){super(),U(this,e,ll,nl,V,{expand:0,disabled:1})}}function rl(r){let e,t,n;return{c(){e=L("path"),t=D(),n=L("path"),c(e,"d","M39 57V147C39 163.569 52.4315 177 69 177H127"),c(e,"stroke-width","20"),c(e,"stroke-linecap","round"),c(e,"class","below svelte-vhy15y"),c(n,"d","M88 144H146C154.284 144 161 137.284 161 129V39C161 30.7157 154.284 24 146 24H88C79.7157 24 73 30.7157 73 39V129C73 137.284 79.7157 144 88 144Z"),c(n,"stroke-width","20"),c(n,"stroke-linecap","round"),c(n,"class","above svelte-vhy15y")},m(l,s){k(l,e,s),k(l,t,s),k(l,n,s)},p:C,i:C,o:C,d(l){l&&(b(e),b(t),b(n))}}}class sl extends z{constructor(e){super(),U(this,e,null,rl,V,{})}}function ol(r){let e,t,n,l,s;return{c(){e=L("path"),t=D(),n=L("g"),l=L("path"),s=L("path"),c(e,"d","M83 37H44C35.7157 37 29 43.7157 29 52V159.5C29 167.784 35.7157 174.5 44 174.5H151.5C159.784 174.5 166.5 167.784 166.5 159.5V113"),c(e,"stroke-width","20"),c(e,"stroke-linecap","round"),c(e,"class","window svelte-1wva86d"),c(l,"d","M114.325 29H166.5V81.1749L140.413 55.0874L114.325 29Z"),c(l,"fill","currentColor"),c(s,"d","M166.5 29H114.325L166.5 81.1749V29ZM166.5 29L89 106.5"),c(s,"stroke-width","20"),c(s,"stroke-linecap","round"),c(s,"stroke-linejoin","round"),c(n,"class","arrow svelte-1wva86d")},m(o,i){k(o,e,i),k(o,t,i),k(o,n,i),$(n,l),$(n,s)},p:C,i:C,o:C,d(o){o&&(b(e),b(t),b(n))}}}class il extends z{constructor(e){super(),U(this,e,null,ol,V,{})}}function ul(r){let e;return{c(){e=L("path"),c(e,"d","M53.1984 27.25L169.397 119.512L115.627 135.379L75 174.012L53.1984 27.25Z"),c(e,"stroke-width","20"),c(e,"stroke-linejoin","round"),c(e,"class","svelte-11rengu")},m(t,n){k(t,e,n)},p:C,i:C,o:C,d(t){t&&b(e)}}}class al extends z{constructor(e){super(),U(this,e,null,ul,V,{})}}function fl(r){let e,t,n;return{c(){e=L("g"),t=L("path"),n=L("path"),c(t,"d","M79.1126 161.07L168.685 71.4975C174.543 65.6396 174.543 56.1421 168.685 50.2843L151.008 32.6066C145.15 26.7487 135.652 26.7488 129.794 32.6066L40.2217 122.179"),c(t,"stroke-width","20"),c(n,"fill-rule","evenodd"),c(n,"clip-rule","evenodd"),c(n,"d","M33.5166 114.742C33.5166 114.742 33.5165 114.742 33.5165 114.742C18.8719 129.387 18.8719 153.131 33.5165 167.775C48.1612 182.42 71.9049 182.42 86.5495 167.775L33.5166 114.742Z"),c(n,"fill","currentColor"),c(e,"class","top svelte-1p4czs2")},m(l,s){k(l,e,s),$(e,t),$(e,n)},p:C,i:C,o:C,d(l){l&&b(e)}}}class cl extends z{constructor(e){super(),U(this,e,null,fl,V,{})}}function dl(r){let e,t,n;return{c(){e=L("path"),t=D(),n=L("path"),c(e,"d","M49 30V85C49 113.167 71.8335 136 100 136V136C128.167 136 151 113.167 151 85V30"),c(e,"stroke-width","20"),c(e,"stroke-linecap","round"),c(e,"class","letter svelte-1b9a7h6"),c(n,"class","line svelte-1b9a7h6"),c(n,"d","M50 171H150"),c(n,"stroke-width","20"),c(n,"stroke-linecap","round")},m(l,s){k(l,e,s),k(l,t,s),k(l,n,s)},p:C,i:C,o:C,d(l){l&&(b(e),b(t),b(n))}}}class pl extends z{constructor(e){super(),U(this,e,null,dl,V,{})}}function hl(r){let e,t,n;return{c(){e=L("g"),t=L("path"),n=L("path"),c(t,"d","M178.248 76.0974L132.733 30.5824C126.857 24.7063 117.323 24.7273 111.473 30.6295L28.9733 113.862C23.1596 119.727 23.1805 129.189 29.0201 135.028L57.4243 163.432C60.2374 166.245 64.0527 167.826 68.0309 167.826L102.269 167.826C106.277 167.826 110.118 166.222 112.936 163.372L178.308 97.2499C184.109 91.3825 184.082 81.9316 178.248 76.0974Z"),c(t,"stroke-width","20"),c(n,"d","M97.7754 30.2132C109.491 18.4975 128.486 18.4975 140.202 30.2132L179.093 69.1041C190.808 80.8198 190.808 99.8148 179.093 111.53L159.712 130.911L78.3952 49.5935L97.7754 30.2132Z"),c(n,"fill","currentColor"),c(e,"class","svelte-1jmacb")},m(l,s){k(l,e,s),$(e,t),$(e,n)},p:C,i:C,o:C,d(l){l&&b(e)}}}class gl extends z{constructor(e){super(),U(this,e,null,hl,V,{})}}function ml(r){let e,t,n,l,s;return{c(){e=L("path"),t=D(),n=L("path"),l=D(),s=L("path"),c(e,"d","M172.664 45L27 45"),c(e,"stroke-width","20"),c(e,"class","top svelte-1302pyf"),c(e,"stroke-linecap","round"),c(n,"d","M173.664 100L28 100"),c(n,"stroke-width","20"),c(n,"stroke-linecap","round"),c(n,"class","middle"),c(s,"d","M134 155H28"),c(s,"stroke-width","20"),c(s,"stroke-linecap","round"),c(s,"class","bottom svelte-1302pyf")},m(o,i){k(o,e,i),k(o,t,i),k(o,n,i),k(o,l,i),k(o,s,i)},p:C,i:C,o:C,d(o){o&&(b(e),b(t),b(n),b(l),b(s))}}}class _l extends z{constructor(e){super(),U(this,e,null,ml,V,{})}}function $l(r){let e,t,n;return{c(){e=L("g"),t=L("path"),n=L("path"),c(t,"d","M183.403 127.012L132.012 118L174.391 178.402L183.403 127.012Z"),c(t,"fill","currentColor"),c(t,"stroke-width","20"),c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(n,"d","M152.5 48.1264C140.354 37.4642 124.432 31 107 31C68.8924 31 38 61.8924 38 100C38 138.108 68.8924 169 107 169C124.432 169 140.354 162.536 152.5 151.874"),c(n,"stroke-width","20"),c(n,"stroke-linecap","round"),c(e,"class","svelte-v2qlxf")},m(l,s){k(l,e,s),$(e,t),$(e,n)},p:C,i:C,o:C,d(l){l&&b(e)}}}class kl extends z{constructor(e){super(),U(this,e,null,$l,V,{})}}function bl(r){let e,t,n,l,s,o;return{c(){e=L("g"),t=L("path"),n=D(),l=L("g"),s=L("path"),o=L("path"),c(t,"d","M180.831 175.831L170.626 150.087L168.344 144.331M92.8306 175.831L103.035 150.087L105.317 144.331M105.317 144.331L136.831 64.8306L168.344 144.331M105.317 144.331H168.344"),c(t,"stroke-width","20"),c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(e,"class","letter svelte-r8hzh9"),c(s,"d","M76.78 82.78L76.78 48L59.39 65.39L42 82.78H76.78Z"),c(s,"fill","currentColor"),c(o,"d","M59.39 65.39L42 82.78H76.78L76.78 48L59.39 65.39ZM59.39 65.39L23.5 29.5"),c(o,"stroke-width","20"),c(o,"stroke-linecap","round"),c(o,"stroke-linejoin","round"),c(l,"class","arrow svelte-r8hzh9")},m(i,u){k(i,e,u),$(e,t),k(i,n,u),k(i,l,u),$(l,s),$(l,o)},p:C,i:C,o:C,d(i){i&&(b(e),b(n),b(l))}}}class wl extends z{constructor(e){super(),U(this,e,null,bl,V,{})}}function vl(r){let e,t,n;return{c(){e=L("path"),t=D(),n=L("path"),c(e,"fill-rule","evenodd"),c(e,"clip-rule","evenodd"),c(e,"d","M150 76.5C150 104.39 127.39 127 99.5 127C71.6096 127 49 104.39 49 76.5C49 48.6096 71.6096 26 99.5 26C127.39 26 150 48.6096 150 76.5ZM91 87.5C91 94.4036 85.4036 100 78.5 100C71.5964 100 66 94.4036 66 87.5C66 80.5964 71.5964 75 78.5 75C85.4036 75 91 80.5964 91 87.5ZM120.5 100C127.404 100 133 94.4036 133 87.5C133 80.5964 127.404 75 120.5 75C113.596 75 108 80.5964 108 87.5C108 94.4036 113.596 100 120.5 100Z"),c(e,"fill","currentColor"),c(e,"class","head svelte-1j3a471"),c(n,"d","M33 171C33 144.856 47.786 122.187 69.4016 111C69.4016 111 87.068 118.375 100 118.375C112.932 118.375 130.598 111 130.598 111C152.214 122.187 167 144.856 167 171"),c(n,"stroke-width","20"),c(n,"stroke-linecap","round")},m(l,s){k(l,e,s),k(l,t,s),k(l,n,s)},p:C,i:C,o:C,d(l){l&&(b(e),b(t),b(n))}}}class Cl extends z{constructor(e){super(),U(this,e,null,vl,V,{})}}function yl(r){let e,t,n,l,s,o,i,u,f,a,p;return{c(){e=L("path"),t=D(),n=L("line"),l=D(),s=L("line"),o=D(),i=L("line"),u=D(),f=L("line"),a=D(),p=L("path"),c(e,"d","M94.5139 8.86813C97.6008 7.09245 101.399 7.09245 104.486 8.86813L184.392 54.8318C193.268 59.9373 189.646 73.5 179.406 73.5H19.5938C9.3543 73.5 5.73181 59.9373 14.6077 54.8318L94.5139 8.86813Z"),c(e,"fill","currentColor"),c(e,"class","roof svelte-4lnx64"),c(n,"x1","45"),c(n,"y1","96"),c(n,"x2","45"),c(n,"y2","147"),c(n,"stroke-width","20"),c(n,"stroke-linecap","round"),c(s,"x1","82"),c(s,"y1","96"),c(s,"x2","82"),c(s,"y2","147"),c(s,"stroke-width","20"),c(s,"stroke-linecap","round"),c(i,"x1","118"),c(i,"y1","96"),c(i,"x2","118"),c(i,"y2","147"),c(i,"stroke-width","20"),c(i,"stroke-linecap","round"),c(f,"x1","155"),c(f,"y1","96"),c(f,"x2","155"),c(f,"y2","147"),c(f,"stroke-width","20"),c(f,"stroke-linecap","round"),c(p,"d","M175 179.5L25 179.5"),c(p,"stroke-width","20"),c(p,"stroke-linecap","round")},m(d,h){k(d,e,h),k(d,t,h),k(d,n,h),k(d,l,h),k(d,s,h),k(d,o,h),k(d,i,h),k(d,u,h),k(d,f,h),k(d,a,h),k(d,p,h)},p:C,i:C,o:C,d(d){d&&(b(e),b(t),b(n),b(l),b(s),b(o),b(i),b(u),b(f),b(a),b(p))}}}class Ll extends z{constructor(e){super(),U(this,e,null,yl,V,{})}}function Il(r){let e,t,n;return{c(){e=L("g"),t=L("path"),n=L("path"),c(t,"d","M149.995 149.995L50.9999 51"),c(t,"stroke-width","20"),c(t,"stroke-linecap","round"),c(n,"d","M51 149.995L149.995 51"),c(n,"stroke-width","20"),c(n,"stroke-linecap","round"),c(e,"class","svelte-ic3z83")},m(l,s){k(l,e,s),$(e,t),$(e,n)},p:C,i:C,o:C,d(l){l&&b(e)}}}class Pl extends z{constructor(e){super(),U(this,e,null,Il,V,{})}}function Ml(r){let e;return{c(){e=L("path"),c(e,"d","M174.492 50.4975C174.492 50.4975 117.721 107.269 79.0307 145.959C77.0781 147.912 73.9146 147.91 71.9619 145.957L26 99.995"),c(e,"stroke-width","20"),c(e,"stroke-linecap","round")},m(t,n){k(t,e,n)},p:C,i:C,o:C,d(t){t&&b(e)}}}class El extends z{constructor(e){super(),U(this,e,null,Ml,V,{})}}function Ol(r){let e,t,n,l,s,o,i,u,f;return{c(){e=L("g"),t=L("path"),n=L("g"),l=L("circle"),s=L("circle"),o=L("path"),i=L("path"),u=L("path"),f=L("path"),c(t,"d","M23 123C23 89.8629 49.8629 63 83 63H99.5H116C149.137 63 176 89.8629 176 123V168C176 173.523 171.523 178 166 178H33C27.4772 178 23 173.523 23 168V123Z"),c(t,"stroke","currentColor"),c(t,"stroke-width","20"),c(l,"cx","70"),c(l,"cy","123"),c(l,"r","15"),c(l,"fill","currentColor"),c(s,"cx","130"),c(s,"cy","123"),c(s,"r","15"),c(s,"fill","currentColor"),c(n,"class","eyes svelte-9mkbq2"),c(o,"d","M55.2075 14L68.2367 63.4556"),c(o,"stroke","currentColor"),c(o,"stroke-width","20"),c(o,"stroke-linecap","round"),c(o,"class","antlerLeft svelte-9mkbq2"),c(i,"d","M144.237 14L131.208 63.4556"),c(i,"stroke","currentColor"),c(i,"stroke-width","20"),c(i,"stroke-linecap","round"),c(i,"class","antlerRight svelte-9mkbq2"),c(u,"d","M190 108C195.523 108 200 112.477 200 118L200 148C200 153.523 195.523 158 190 158L180 158L180 108L190 108Z"),c(u,"fill","currentColor"),c(f,"d","M10 111C4.47715 111 1.95703e-07 115.477 4.37114e-07 121L1.74846e-06 151C1.98987e-06 156.523 4.47716 161 10 161L20 161L20 111L10 111Z"),c(f,"fill","currentColor"),c(e,"class","svelte-9mkbq2")},m(a,p){k(a,e,p),$(e,t),$(e,n),$(n,l),$(n,s),$(e,o),$(e,i),$(e,u),$(e,f)},p:C,i:C,o:C,d(a){a&&b(e)}}}class Tl extends z{constructor(e){super(),U(this,e,null,Ol,V,{})}}function Dl(r){let e,t,n,l,s,o,i,u,f;return{c(){e=L("g"),t=L("path"),n=L("g"),l=L("path"),s=L("g"),o=L("path"),i=L("path"),u=L("path"),f=L("path"),c(t,"class","back svelte-9rkroy"),c(t,"d","M180 160C180 171.046 171.046 180 160 180H100H40C28.9543 180 20 171.046 20 160V40C20 28.9543 28.9543 20 40 20H160C171.046 20 180 28.9543 180 40V160Z"),c(t,"stroke","currentColor"),c(t,"stroke-width","20"),c(l,"d","M133 101.5C133 119.449 118.449 134 100.5 134V134V134C82.5507 134 68 119.449 68 101.5V101.5C68 83.5508 82.5507 69 100.5 69V69C118.449 69 133 83.5507 133 101.5V101.5Z"),c(l,"stroke","currentColor"),c(l,"stroke-width","20"),c(o,"d","M153.355 62.2132C157.261 58.308 157.261 51.9763 153.355 48.0711V48.0711C149.45 44.1658 143.119 44.1658 139.213 48.0711L118 69.2843L132.142 83.4264L153.355 62.2132Z"),c(o,"fill","currentColor"),c(i,"d","M47.0711 140.213C43.1658 144.118 43.1658 150.45 47.0711 154.355V154.355C50.9763 158.261 57.308 158.261 61.2132 154.355L82.4264 133.142L68.2843 119L47.0711 140.213Z"),c(i,"fill","currentColor"),c(u,"d","M139.213 154.355C143.118 158.261 149.45 158.261 153.355 154.355V154.355C157.26 150.45 157.26 144.118 153.355 140.213L132.142 119L118 133.142L139.213 154.355Z"),c(u,"fill","currentColor"),c(f,"d","M61.2132 48.0711C57.3079 44.1658 50.9763 44.1658 47.071 48.0711V48.0711C43.1658 51.9763 43.1658 58.308 47.071 62.2132L68.2842 83.4264L82.4264 69.2843L61.2132 48.0711Z"),c(f,"fill","currentColor"),c(s,"class","teeth svelte-9rkroy"),c(n,"class","wheel svelte-9rkroy"),c(e,"class","svelte-9rkroy")},m(a,p){k(a,e,p),$(e,t),$(e,n),$(n,l),$(n,s),$(s,o),$(s,i),$(s,u),$(s,f)},p:C,i:C,o:C,d(a){a&&b(e)}}}class Al extends z{constructor(e){super(),U(this,e,null,Dl,V,{})}}function Hl(r){let e,t,n,l,s;return{c(){e=L("g"),t=L("path"),n=L("g"),l=L("path"),s=L("path"),c(t,"class","box svelte-dg01c8"),c(t,"d","M100 180H135H165C176.046 180 185 171.046 185 160V40C185 28.9543 176.046 20 165 20H100"),c(t,"stroke","currentColor"),c(t,"stroke-width","20"),c(t,"stroke-linecap","round"),c(l,"d","M61.8932 136.694L25 99.8008L61.8932 62.9076L61.8932 99.8008V136.694Z"),c(l,"fill","currentColor"),c(s,"d","M25 99.8008L61.8932 136.694L61.8932 62.9076L25 99.8008ZM25 99.8008L134.602 99.8008"),c(s,"stroke","currentColor"),c(s,"stroke-width","20"),c(s,"stroke-linecap","round"),c(s,"stroke-linejoin","round"),c(n,"class","arrow svelte-dg01c8"),c(e,"class","top svelte-dg01c8")},m(o,i){k(o,e,i),$(e,t),$(e,n),$(n,l),$(n,s)},p:C,i:C,o:C,d(o){o&&b(e)}}}class Sl extends z{constructor(e){super(),U(this,e,null,Hl,V,{})}}function Rl(r){let e,t,n,l,s;return{c(){e=L("g"),t=L("path"),n=L("g"),l=L("path"),s=L("path"),c(t,"class","box svelte-lqs0kb"),c(t,"d","M20 95L20 130L20 160C20 171.046 28.9543 180 40 180L160 180C171.046 180 180 171.046 180 160L180 95"),c(t,"stroke","currentColor"),c(t,"stroke-width","20"),c(t,"stroke-linecap","round"),c(l,"d","M137.092 56.8932L100.199 20L63.306 56.8932L100.199 56.8932L137.092 56.8932Z"),c(l,"fill","currentColor"),c(s,"d","M100.199 20L137.092 56.8932L63.306 56.8932L100.199 20ZM100.199 20L100.199 129.602"),c(s,"stroke","currentColor"),c(s,"stroke-width","20"),c(s,"stroke-linecap","round"),c(s,"stroke-linejoin","round"),c(n,"class","arrow svelte-lqs0kb"),c(e,"class","top svelte-lqs0kb")},m(o,i){k(o,e,i),$(e,t),$(e,n),$(n,l),$(n,s)},p:C,i:C,o:C,d(o){o&&b(e)}}}class Nl extends z{constructor(e){super(),U(this,e,null,Rl,V,{})}}function zl(r){let e,t,n,l,s;return{c(){e=L("g"),t=L("g"),n=L("path"),l=L("g"),s=L("path"),c(n,"d","M146 83L146 56.5C146 31.371 125.629 11 100.5 11V11C75.371 11 55 31.371 55 56.5L55 83"),c(n,"stroke","currentColor"),c(n,"stroke-width","20"),c(n,"stroke-linecap","round"),c(t,"class","horseshoe svelte-ym1ll2"),c(s,"fill-rule","evenodd"),c(s,"clip-rule","evenodd"),c(s,"d","M39 83C27.9543 83 19 91.9543 19 103V170C19 181.046 27.9543 190 39 190H161C172.046 190 181 181.046 181 170V103C181 91.9543 172.046 83 161 83H100H39ZM120 124C120 131.403 115.978 137.866 110 141.324V159C110 164.523 105.523 169 100 169C94.4771 169 90 164.523 90 159V141.324C84.022 137.866 80 131.403 80 124C80 112.954 88.9543 104 100 104C111.046 104 120 112.954 120 124Z"),c(s,"fill","currentColor"),c(l,"class","box svelte-ym1ll2"),c(e,"class","svelte-ym1ll2")},m(o,i){k(o,e,i),$(e,t),$(t,n),$(e,l),$(l,s)},p:C,i:C,o:C,d(o){o&&b(e)}}}class Ul extends z{constructor(e){super(),U(this,e,null,zl,V,{})}}function Vl(r){let e,t,n;var l=r[1][r[0]];function s(o,i){return{}}return l&&(t=je(l,s())),{c(){e=L("svg"),t&&I(t.$$.fragment),c(e,"width","200"),c(e,"height","200"),c(e,"viewBox","0 0 200 200"),c(e,"fill","none"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"class","svelte-t62kgi")},m(o,i){k(o,e,i),t&&P(t,e,null),n=!0},p(o,[i]){if(i&1&&l!==(l=o[1][o[0]])){if(t){F();const u=t;m(u.$$.fragment,1,0,()=>{M(u,1)}),Y()}l?(t=je(l,s()),I(t.$$.fragment),g(t.$$.fragment,1),P(t,e,null)):t=null}},i(o){n||(t&&g(t.$$.fragment,o),n=!0)},o(o){t&&m(t.$$.fragment,o),n=!1},d(o){o&&b(e),t&&M(t)}}}function Zl(r,e,t){let n={copy:sl,popout:il,cursor:al,highlight:cl,underline:pl,eraser:gl,merge:_l,reload:kl,shrink:wl,person:Cl,organization:Ll,delete:Pl,check:El,robot:Tl,vault:Al,login:Sl,upload:Nl,lock:Ul},{name:l}=e;return r.$$set=s=>{"name"in s&&t(0,l=s.name)},[l,n]}class x extends z{constructor(e){super(),U(this,e,Zl,Vl,V,{name:0})}}function ql(r){let e;return{c(){e=J("Login")},m(t,n){k(t,e,n)},d(t){t&&b(e)}}}function Kl(r){let e,t,n,l;return n=new x({props:{name:"popout"}}),{c(){e=E("span"),e.textContent="Register",t=D(),I(n.$$.fragment)},m(s,o){k(s,e,o),k(s,t,o),P(n,s,o),l=!0},p:C,i(s){l||(g(n.$$.fragment,s),l=!0)},o(s){m(n.$$.fragment,s),l=!1},d(s){s&&(b(e),b(t)),M(n,s)}}}function jl(r){let e,t,n,l,s,o,i,u,f,a,p,d,h,_,T,y;return f=new ve({props:{$$slots:{default:[ql]},$$scope:{ctx:r}}}),f.$on("click",r[14]),h=new ve({props:{$$slots:{default:[Kl]},$$scope:{ctx:r}}}),h.$on("click",r[15]),{c(){e=E("h1"),e.textContent="Login to Arguflow",t=D(),n=E("div"),l=E("input"),s=D(),o=E("input"),i=D(),u=E("div"),I(f.$$.fragment),a=D(),p=E("span"),p.textContent="or",d=D(),I(h.$$.fragment),c(e,"class","svelte-1xevmsn"),c(l,"type","text"),c(l,"placeholder","email"),c(l,"class","svelte-1xevmsn"),H(l,"invalid",r[4]),c(o,"type","password"),c(o,"placeholder","password"),c(o,"class","svelte-1xevmsn"),H(o,"invalid",r[5]),c(u,"class","buttons svelte-1xevmsn"),c(n,"class","content svelte-1xevmsn")},m(v,A){k(v,e,A),k(v,t,A),k(v,n,A),$(n,l),r[8](l),ue(l,r[2]),$(n,s),$(n,o),r[11](o),ue(o,r[3]),$(n,i),$(n,u),P(f,u,null),$(u,a),$(u,p),$(u,d),P(h,u,null),_=!0,T||(y=[Z(l,"input",r[9]),Z(l,"keydown",r[10]),Z(o,"input",r[12]),Z(o,"keydown",r[13])],T=!0)},p(v,[A]){A&4&&l.value!==v[2]&&ue(l,v[2]),(!_||A&16)&&H(l,"invalid",v[4]),A&8&&o.value!==v[3]&&ue(o,v[3]),(!_||A&32)&&H(o,"invalid",v[5]);const O={};A&65536&&(O.$$scope={dirty:A,ctx:v}),f.$set(O);const K={};A&65536&&(K.$$scope={dirty:A,ctx:v}),h.$set(K)},i(v){_||(g(f.$$.fragment,v),g(h.$$.fragment,v),_=!0)},o(v){m(f.$$.fragment,v),m(h.$$.fragment,v),_=!1},d(v){v&&(b(e),b(t),b(n)),r[8](null),r[11](null),M(f),M(h),T=!1,pe(y)}}}function Bl(r,e,t){let{closePopup:n}=e,l,s,o="",i="";Ce(function(){l.focus(),chrome.storage.local.get("arguflowLogin",O=>{O.arguflowLogin&&(t(2,o=O.arguflowLogin.email),t(3,i=O.arguflowLogin.password),s.focus())})});let u=!1,f=!1;function a(O,K){t(4,u=!1),t(5,f=!1),O.length==0&&(t(4,u=!0),W.addErrorMessage("Email is required")),K.length==0&&(t(5,f=!0),W.addErrorMessage("Password is required")),!(u||f)&&Yn(O,K).then(()=>{W.addMessage("Logged in"),n()}).catch(G=>{t(4,u=!0),t(5,f=!0),W.addError("login",G)})}function p(O){X[O?"unshift":"push"](()=>{l=O,t(0,l)})}function d(){o=this.value,t(2,o)}const h=O=>{O.key=="Enter"&&s.focus()};function _(O){X[O?"unshift":"push"](()=>{s=O,t(1,s)})}function T(){i=this.value,t(3,i)}const y=O=>{O.key=="Enter"&&a(o,i)},v=()=>{a(o,i)},A=()=>{window.open("https://vault.arguflow.ai/auth/register","_blank")};return r.$$set=O=>{"closePopup"in O&&t(7,n=O.closePopup)},[l,s,o,i,u,f,a,n,p,d,h,_,T,y,v,A]}class Wl extends z{constructor(e){super(),U(this,e,Bl,jl,V,{closePopup:7})}}function Kt(r){const e=t=>{r.contains(t.target)||r.dispatchEvent(new CustomEvent("outclick",{detail:{target:t.target}}))};return document.addEventListener("click",e,!0),{destroy(){document.removeEventListener("click",e,!0)}}}let Fl={backInOut:Qt,backIn:Xt,backOut:xt,bounceOut:en,bounceInOut:tn,bounceIn:nn,circInOut:ln,circIn:rn,circOut:sn,cubicInOut:on,cubicIn:un,cubicOut:an,elasticInOut:fn,elasticIn:cn,elasticOut:dn,expoInOut:pn,expoIn:hn,expoOut:gn,quadInOut:mn,quadIn:_n,quadOut:$n,quartInOut:kn,quartIn:bn,quartOut:wn,quintInOut:vn,quintIn:Cn,quintOut:yn,sineInOut:Ln,sineIn:In,sineOut:Pn},et=200;function he(r,e=null,t={}){return t=Object.assign({durationMultiplier:1,preRun:null,delay:0},t),function(l,{delay:s=t.delay,duration:o=et*t.durationMultiplier}={}){let i=null;t.preRun!=null&&(i=t.preRun(l));let u=null;return e!=null&&(u=Fl[e]),{delay:s,duration:o,css:f=>{let a=null;return u!=null&&(a=u(f)),r(f,a,i)}}}}function Yl(r){let e;const t=r[15].default,n=He(t,r,r[14],null);return{c(){n&&n.c()},m(l,s){n&&n.m(l,s),e=!0},p(l,s){n&&n.p&&(!e||s&16384)&&Se(n,t,l,l[14],e?Ne(t,l[14],s,null):Re(l[14]),null)},i(l){e||(g(n,l),e=!0)},o(l){m(n,l),e=!1},d(l){n&&n.d(l)}}}function Gl(r){let e,t,n,l,s,o;const i=r[15].default,u=He(i,r,r[14],null);let f=r[4]&&pt(r);return{c(){e=E("div"),u&&u.c(),t=D(),f&&f.c(),n=Ee(),c(e,"class","element svelte-15bwfk4")},m(a,p){k(a,e,p),u&&u.m(e,null),r[16](e),k(a,t,p),f&&f.m(a,p),k(a,n,p),l=!0,s||(o=[Z(e,"mouseover",r[10]),Z(e,"focus",r[10]),Z(e,"mouseleave",r[12]),Z(e,"blur",r[12]),Z(e,"mousemove",r[11])],s=!0)},p(a,p){u&&u.p&&(!l||p&16384)&&Se(u,i,a,a[14],l?Ne(i,a[14],p,null):Re(a[14]),null),a[4]?f?(f.p(a,p),p&16&&g(f,1)):(f=pt(a),f.c(),g(f,1),f.m(n.parentNode,n)):f&&(F(),m(f,1,1,()=>{f=null}),Y())},i(a){l||(g(u,a),g(f),l=!0)},o(a){m(u,a),m(f),l=!1},d(a){a&&(b(e),b(t),b(n)),u&&u.d(a),r[16](null),f&&f.d(a),s=!1,pe(o)}}}function pt(r){let e,t,n,l,s,o;return{c(){e=E("div"),t=E("div"),n=J(r[1]),c(t,"class","content"),Ze(e,"top",r[6]+"px"),Ze(e,"left",r[5]+"px"),c(e,"class","tooltip svelte-15bwfk4"),H(e,"disabled",r[2])},m(i,u){k(i,e,u),$(e,t),$(t,n),r[17](e),o=!0},p(i,u){(!o||u&2)&&ye(n,i[1]),(!o||u&64)&&Ze(e,"top",i[6]+"px"),(!o||u&32)&&Ze(e,"left",i[5]+"px"),(!o||u&4)&&H(e,"disabled",i[2])},i(i){o||(i&&ge(()=>{o&&(s&&s.end(1),l=Mn(e,r[8],{}),l.start())}),o=!0)},o(i){l&&l.invalidate(),i&&(s=En(e,r[9],{})),o=!1},d(i){i&&b(e),r[17](null),i&&s&&s.end()}}}function Jl(r){let e,t,n,l;const s=[Gl,Yl],o=[];function i(u,f){return u[1]&&u[0]?0:1}return e=i(r),t=o[e]=s[e](r),{c(){t.c(),n=Ee()},m(u,f){o[e].m(u,f),k(u,n,f),l=!0},p(u,[f]){let a=e;e=i(u),e===a?o[e].p(u,f):(F(),m(o[a],1,1,()=>{o[a]=null}),Y(),t=o[e],t?t.p(u,f):(t=o[e]=s[e](u),t.c()),g(t,1),t.m(n.parentNode,n))},i(u){l||(g(t),l=!0)},o(u){m(t),l=!1},d(u){u&&b(n),o[e].d(u)}}}function Ql(r,e,t){let n;Q(r,Ae,N=>t(19,n=N));let{$$slots:l={},$$scope:s}=e,{exist:o=!0}=e,{content:i=""}=e,{disabled:u=!1}=e,{layout:f="bottom"}=e,a=!1,p=0,d=0,h,_,T=he((N,fe)=>`
      transform: scale(${fe});
    `,"sineOut"),y=he((N,fe)=>`
      transform: scale(${fe});
      z-index: -1;
    `,"sineOut"),v=null;async function A(){t(4,a=!0),K(),await at(),oe(Ae,n.open=!0,n)}function O(){a||(oe(Ae,n.claimed=!0,n),n.open?A():v==null&&(v=setTimeout(A,1e3)))}function K(){if(_){let N=h.getBoundingClientRect();f=="bottom"||f=="top"?(t(5,p=N.left-_.offsetWidth/2+N.width/2),p<4?t(5,p=4):p+_.offsetWidth>window.innerWidth-4&&t(5,p=window.innerWidth-_.offsetWidth-4),f=="bottom"?t(6,d=N.bottom+4):f=="top"&&t(6,d=N.top-_.offsetHeight-4)):(f=="left"||f=="right")&&(t(6,d=N.top-_.offsetHeight/2+N.height/2),d<4?t(6,d=4):d+_.offsetHeight>window.innerHeight-4&&t(6,d=window.innerHeight-_.offsetHeight-4),f=="left"?t(5,p=N.left-_.offsetWidth-4):f=="right"&&t(5,p=N.right+4))}}async function G(){await at(),K()}function j(){v!=null&&(clearTimeout(v),v=null),oe(Ae,n.claimed=!1,n),t(4,a=!1),setTimeout(function(){n.claimed||oe(Ae,n.open=!1,n)},200)}function R(N){X[N?"unshift":"push"](()=>{h=N,t(7,h)})}function B(N){X[N?"unshift":"push"](()=>{_=N,t(3,_)})}return r.$$set=N=>{"exist"in N&&t(0,o=N.exist),"content"in N&&t(1,i=N.content),"disabled"in N&&t(2,u=N.disabled),"layout"in N&&t(13,f=N.layout),"$$scope"in N&&t(14,s=N.$$scope)},r.$$.update=()=>{r.$$.dirty&14&&G()},[o,i,u,_,a,p,d,h,T,y,O,K,j,f,s,l,R,B]}class Xl extends z{constructor(e){super(),U(this,e,Ql,Jl,V,{exist:0,content:1,disabled:2,layout:13})}}function xl(r){let e,t,n,l;const s=r[8].default,o=He(s,r,r[11],null);return{c(){e=E("button"),o&&o.c(),e.disabled=r[2],c(e,"class","svelte-114b3tl"),H(e,"selected",r[0]),H(e,"selectedColor",r[1])},m(i,u){k(i,e,u),o&&o.m(e,null),r[10](e),t=!0,n||(l=[Z(e,"click",r[9]),Z(e,"click",r[5]),Z(e,"mouseenter",r[6])],n=!0)},p(i,u){o&&o.p&&(!t||u&2048)&&Se(o,s,i,i[11],t?Ne(s,i[11],u,null):Re(i[11]),null),(!t||u&4)&&(e.disabled=i[2]),(!t||u&1)&&H(e,"selected",i[0]),(!t||u&2)&&H(e,"selectedColor",i[1])},i(i){t||(g(o,i),t=!0)},o(i){m(o,i),t=!1},d(i){i&&b(e),o&&o.d(i),r[10](null),n=!1,pe(l)}}}function er(r){let e,t;const n=[r[3]];let l={$$slots:{default:[xl]},$$scope:{ctx:r}};for(let s=0;s<n.length;s+=1)l=At(l,n[s]);return e=new Xl({props:l}),{c(){I(e.$$.fragment)},m(s,o){P(e,s,o),t=!0},p(s,[o]){const i=o&8?Ht(n,[St(s[3])]):{};o&2071&&(i.$$scope={dirty:o,ctx:s}),e.$set(i)},i(s){t||(g(e.$$.fragment,s),t=!0)},o(s){m(e.$$.fragment,s),t=!1},d(s){M(e,s)}}}function tr(r,e,t){let{$$slots:n={},$$scope:l}=e,{selected:s=!1}=e,{selectedColor:o=!0}=e,{disabled:i=!1}=e,{tooltip:u=null}=e,f;function a(){u==null?t(3,f={exist:!1}):typeof u=="string"?t(3,f={content:u}):t(3,f=u),i&&!f.hasOwnProperty("disabled")&&t(3,f.disabled=!0,f)}let p;function d(){p.classList.remove("clicked"),p.offsetWidth,p.classList.add("clicked")}async function h(){d()}function _(){p.classList.remove("hovered"),p.offsetWidth,p.classList.add("hovered")}function T(v){Dt.call(this,r,v)}function y(v){X[v?"unshift":"push"](()=>{p=v,t(4,p)})}return r.$$set=v=>{"selected"in v&&t(0,s=v.selected),"selectedColor"in v&&t(1,o=v.selectedColor),"disabled"in v&&t(2,i=v.disabled),"tooltip"in v&&t(7,u=v.tooltip),"$$scope"in v&&t(11,l=v.$$scope)},r.$$.update=()=>{r.$$.dirty&132&&a()},[s,o,i,f,p,h,_,u,n,T,y,l]}class re extends z{constructor(e){super(),U(this,e,tr,er,V,{selected:0,selectedColor:1,disabled:2,tooltip:7})}}function ht(r,e,t){const n=r.slice();return n[17]=e[t],n[18]=e,n[19]=t,n}function gt(r){let e,t,n,l={ctx:r,current:null,token:null,hasCatch:!0,pending:or,then:lr,catch:nr,value:16,error:20,blocks:[,,,]};return ft(t=dt(r[3]),l),{c(){e=E("div"),l.block.c(),c(e,"class","bookmark")},m(s,o){k(s,e,o),l.block.m(e,l.anchor=null),l.mount=()=>e,l.anchor=null,n=!0},p(s,o){r=s,l.ctx=r,o&8&&t!==(t=dt(r[3]))&&ft(t,l)||Tn(l,r,o)},i(s){n||(g(l.block),n=!0)},o(s){for(let o=0;o<3;o+=1){const i=l.blocks[o];m(i)}n=!1},d(s){s&&b(e),l.block.d(),l.token=null,l=null}}}function nr(r){let e,t,n=r[20]+"",l;return{c(){e=E("div"),t=J("Failed to load collections: "),l=J(n),c(e,"class","loader error svelte-1ufzgkh")},m(s,o){k(s,e,o),$(e,t),$(e,l)},p(s,o){o&8&&n!==(n=s[20]+"")&&ye(l,n)},i:C,o:C,d(s){s&&b(e)}}}function lr(r){let e,t,n,l,s,o,i=de(r[16].collections),u=[];for(let d=0;d<i.length;d+=1)u[d]=_t(ht(r,i,d));const f=d=>m(u[d],1,1,()=>{u[d]=null});let a=r[3]!=1&&$t(r),p=r[3]!=r[16].total_pages&&kt(r);return{c(){e=E("div"),t=E("div");for(let d=0;d<u.length;d+=1)u[d].c();n=D(),l=E("div"),a&&a.c(),s=D(),p&&p.c(),c(l,"class","buttons svelte-1ufzgkh"),c(t,"class","collections svelte-1ufzgkh"),c(e,"class","collectionsScroll svelte-1ufzgkh")},m(d,h){k(d,e,h),$(e,t);for(let _=0;_<u.length;_+=1)u[_]&&u[_].m(t,null);$(t,n),$(t,l),a&&a.m(l,null),$(l,s),p&&p.m(l,null),o=!0},p(d,h){if(h&12){i=de(d[16].collections);let _;for(_=0;_<i.length;_+=1){const T=ht(d,i,_);u[_]?(u[_].p(T,h),g(u[_],1)):(u[_]=_t(T),u[_].c(),g(u[_],1),u[_].m(t,n))}for(F(),_=i.length;_<u.length;_+=1)f(_);Y()}d[3]!=1?a?(a.p(d,h),h&8&&g(a,1)):(a=$t(d),a.c(),g(a,1),a.m(l,s)):a&&(F(),m(a,1,1,()=>{a=null}),Y()),d[3]!=d[16].total_pages?p?(p.p(d,h),h&8&&g(p,1)):(p=kt(d),p.c(),g(p,1),p.m(l,null)):p&&(F(),m(p,1,1,()=>{p=null}),Y())},i(d){if(!o){for(let h=0;h<i.length;h+=1)g(u[h]);g(a),g(p),o=!0}},o(d){u=u.filter(Boolean);for(let h=0;h<u.length;h+=1)m(u[h]);m(a),m(p),o=!1},d(d){d&&b(e),Xe(u,d),a&&a.d(),p&&p.d()}}}function mt(r){let e,t;return e=new x({props:{name:"check"}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function _t(r){let e,t,n=r[17].name+"",l,s,o,i,u,f,a,p,d,h=r[2][r[17].id]&&mt();function _(){r[8].call(u,r[17])}function T(){return r[9](r[17])}return{c(){e=E("button"),t=E("label"),l=J(n),o=D(),h&&h.c(),i=D(),u=E("input"),c(t,"for",s=r[17].name),c(t,"class","svelte-1ufzgkh"),c(u,"type","checkbox"),c(u,"name",f=r[17].name),u.hidden=!0,c(e,"class","collection svelte-1ufzgkh")},m(y,v){k(y,e,v),$(e,t),$(t,l),$(e,o),h&&h.m(e,null),$(e,i),$(e,u),u.checked=r[2][r[17].id],a=!0,p||(d=[Z(u,"change",_),Z(e,"click",T)],p=!0)},p(y,v){r=y,(!a||v&8)&&n!==(n=r[17].name+"")&&ye(l,n),(!a||v&8&&s!==(s=r[17].name))&&c(t,"for",s),r[2][r[17].id]?h?v&12&&g(h,1):(h=mt(),h.c(),g(h,1),h.m(e,i)):h&&(F(),m(h,1,1,()=>{h=null}),Y()),(!a||v&8&&f!==(f=r[17].name))&&c(u,"name",f),v&12&&(u.checked=r[2][r[17].id])},i(y){a||(g(h),a=!0)},o(y){m(h),a=!1},d(y){y&&b(e),h&&h.d(),p=!1,pe(d)}}}function $t(r){let e,t;return e=new ve({props:{expand:!0,$$slots:{default:[rr]},$$scope:{ctx:r}}}),e.$on("click",r[10]),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p(n,l){const s={};l&2097152&&(s.$$scope={dirty:l,ctx:n}),e.$set(s)},i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function rr(r){let e;return{c(){e=J("Previous")},m(t,n){k(t,e,n)},d(t){t&&b(e)}}}function kt(r){let e,t;return e=new ve({props:{expand:!0,$$slots:{default:[sr]},$$scope:{ctx:r}}}),e.$on("click",r[11]),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p(n,l){const s={};l&2097152&&(s.$$scope={dirty:l,ctx:n}),e.$set(s)},i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function sr(r){let e;return{c(){e=J("Next")},m(t,n){k(t,e,n)},d(t){t&&b(e)}}}function or(r){let e;return{c(){e=E("div"),e.textContent="Loading...",c(e,"class","loader svelte-1ufzgkh")},m(t,n){k(t,e,n)},p:C,i:C,o:C,d(t){t&&b(e)}}}function ir(r){let e,t;return e=new x({props:{name:"lock"}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p:C,i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function ur(r){let e;return{c(){e=J("Select Collections")},m(t,n){k(t,e,n)},d(t){t&&b(e)}}}function ar(r){let e,t,n;return t=new x({props:{name:"upload"}}),{c(){e=J(`Upload\r
      `),I(t.$$.fragment)},m(l,s){k(l,e,s),P(t,l,s),n=!0},p:C,i(l){n||(g(t.$$.fragment,l),n=!0)},o(l){m(t.$$.fragment,l),n=!1},d(l){l&&b(e),M(t,l)}}}function fr(r){let e,t,n,l,s,o,i,u,f,a,p,d=r[0]&&gt(r);return o=new re({props:{tooltip:{content:r[1]?"Private":"Public",layout:"top"},selected:r[1],$$slots:{default:[ir]},$$scope:{ctx:r}}}),o.$on("click",r[12]),u=new ve({props:{expand:!0,$$slots:{default:[ur]},$$scope:{ctx:r}}}),u.$on("click",r[13]),a=new ve({props:{expand:!0,$$slots:{default:[ar]},$$scope:{ctx:r}}}),a.$on("click",r[6]),{c(){e=E("h1"),e.textContent="Upload to Arguflow",t=D(),n=E("div"),d&&d.c(),l=D(),s=E("div"),I(o.$$.fragment),i=D(),I(u.$$.fragment),f=D(),I(a.$$.fragment),c(e,"class","svelte-1ufzgkh"),c(s,"class","buttons svelte-1ufzgkh"),c(n,"class","content svelte-1ufzgkh"),H(n,"bookmark",r[0])},m(h,_){k(h,e,_),k(h,t,_),k(h,n,_),d&&d.m(n,null),$(n,l),$(n,s),P(o,s,null),$(s,i),P(u,s,null),$(s,f),P(a,s,null),p=!0},p(h,[_]){h[0]?d?(d.p(h,_),_&1&&g(d,1)):(d=gt(h),d.c(),g(d,1),d.m(n,l)):d&&(F(),m(d,1,1,()=>{d=null}),Y());const T={};_&2&&(T.tooltip={content:h[1]?"Private":"Public",layout:"top"}),_&2&&(T.selected=h[1]),_&2097152&&(T.$$scope={dirty:_,ctx:h}),o.$set(T);const y={};_&2097152&&(y.$$scope={dirty:_,ctx:h}),u.$set(y);const v={};_&2097152&&(v.$$scope={dirty:_,ctx:h}),a.$set(v),(!p||_&1)&&H(n,"bookmark",h[0])},i(h){p||(g(d),g(o.$$.fragment,h),g(u.$$.fragment,h),g(a.$$.fragment,h),p=!0)},o(h){m(d),m(o.$$.fragment,h),m(u.$$.fragment,h),m(a.$$.fragment,h),p=!1},d(h){h&&(b(e),b(t),b(n)),d&&d.d(),M(o),M(u),M(a)}}}function cr(r,e,t){let n,l;const s=ee("card");Q(r,s,O=>t(14,n=O));const o=ee("shrunk");Q(r,o,O=>t(15,l=O));let{closePopup:i}=e,u=!1,f=!1;async function a(){let O=Ut(n,l,!1,!1);W.addMessage("Uploading...");try{let K=await el(O.innerHTML,n.url,f),G=[];for(let j of Object.keys(p))p[j]&&G.push(j);if(G.length>0){W.addMessage("Adding to collections...");for(let j of G)console.log(j,K.card_metadata.id),await tl(K.card_metadata.id,j)}K.duplicate?W.addMessage("Done, card is a duplicate"):W.addMessage("Done!"),i()}catch(K){W.addError("upload",K)}}let p={},d=1;function h(O){p[O.id]=this.checked,t(2,p)}const _=O=>t(2,p[O.id]=!p[O.id],p),T=()=>{t(3,d--,d)},y=()=>{t(3,d++,d)},v=()=>t(1,f=!f),A=()=>t(0,u=!u);return r.$$set=O=>{"closePopup"in O&&t(7,i=O.closePopup)},[u,f,p,d,s,o,a,i,h,_,T,y,v,A]}class dr extends z{constructor(e){super(),U(this,e,cr,fr,V,{closePopup:7})}}function pr(r){let e,t;return e=new dr({props:{closePopup:r[1]}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p(n,l){const s={};l&2&&(s.closePopup=n[1]),e.$set(s)},i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function hr(r){let e,t;return e=new Wl({props:{closePopup:r[1]}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p(n,l){const s={};l&2&&(s.closePopup=n[1]),e.$set(s)},i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function gr(r){let e,t,n,l,s,o,i,u;const f=[hr,pr],a=[];function p(d,h){return d[0]=="login"?0:d[0]=="upload"?1:-1}return~(n=p(r))&&(l=a[n]=f[n](r)),{c(){e=E("div"),t=E("div"),l&&l.c(),c(t,"class","top svelte-1t0ikaw"),c(e,"class","center levelOne svelte-1t0ikaw")},m(d,h){k(d,e,h),$(e,t),~n&&a[n].m(t,null),o=!0,i||(u=[Rt(Kt.call(null,t)),Z(t,"outclick",r[3])],i=!0)},p(d,[h]){let _=n;n=p(d),n===_?~n&&a[n].p(d,h):(l&&(F(),m(a[_],1,1,()=>{a[_]=null}),Y()),~n?(l=a[n],l?l.p(d,h):(l=a[n]=f[n](d),l.c()),g(l,1),l.m(t,null)):l=null)},i(d){o||(g(l),d&&ge(()=>{o&&(s||(s=ne(t,r[2],{},!0)),s.run(1))}),o=!0)},o(d){m(l),d&&(s||(s=ne(t,r[2],{},!1)),s.run(0)),o=!1},d(d){d&&b(e),~n&&a[n].d(),d&&s&&s.end(),i=!1,pe(u)}}}function mr(r,e,t){let{name:n}=e,{closePopup:l}=e,s=he((i,u)=>`
      transform: translateY(${(1-u)*100}%) scale(${u});
    `,"sineOut",{durationMultiplier:2});function o(){l()}return r.$$set=i=>{"name"in i&&t(0,n=i.name),"closePopup"in i&&t(1,l=i.closePopup)},[n,l,s,o]}class _r extends z{constructor(e){super(),U(this,e,mr,gr,V,{name:0,closePopup:1})}}let Qe={tag:"Tag",title:"Title",siteName:"Site Name",url:"URL",accessDate:"Access Date",date:"Date",authors:"Authors"};function $r(r){let e,t=(r[1]??`Missing ${r[4]}`)+"",n,l,s;return{c(){e=E("span"),n=J(t),c(e,"class","svelte-1kx6gin"),H(e,"editorIsOpen",r[0]),H(e,"invalid",r[1]==null)},m(o,i){k(o,e,i),$(e,n),l||(s=Z(e,"click",r[5]),l=!0)},p(o,[i]){i&2&&t!==(t=(o[1]??`Missing ${o[4]}`)+"")&&ye(n,t),i&1&&H(e,"editorIsOpen",o[0]),i&2&&H(e,"invalid",o[1]==null)},i:C,o:C,d(o){o&&b(e),l=!1,s()}}}function kr(r,e,t){let n,l,s;const o=ee("card");Q(r,o,h=>t(7,l=h));let i=ee("currentEditor");Q(r,i,h=>t(8,s=h));let{formatter:u}=e,f=Qe[u.key],a=!1;function p(){a||oe(i,s=u.key,s)}async function d(){setTimeout(()=>{t(0,a=s==u.key)})}return i.subscribe(d),r.$$set=h=>{"formatter"in h&&t(6,u=h.formatter)},r.$$.update=()=>{r.$$.dirty&192&&t(1,n=u.format(l))},[a,n,o,i,f,p,u,l]}class we extends z{constructor(e){super(),U(this,e,kr,$r,V,{formatter:6})}}function br(r){let e,t,n,l;return{c(){e=E("textarea"),c(e,"placeholder","Type text here"),e.value=t=r[1][r[0]],c(e,"class","svelte-1kv1l1c"),H(e,"invalid",!r[3])},m(s,o){k(s,e,o),r[7](e),n||(l=[Z(e,"input",r[6]),Z(e,"blur",r[8])],n=!0)},p(s,[o]){o&3&&t!==(t=s[1][s[0]])&&(e.value=t),o&8&&H(e,"invalid",!s[3])},i:C,o:C,d(s){s&&b(e),r[7](null),n=!1,pe(l)}}}function wr(r,e,t){let n,{key:l}=e;const s=ee("card");Q(r,s,h=>t(1,n=h));const o=ee("history");let i;Ce(function(){i.focus()});let u;function f(){t(3,u=Ke(n[l]))}function a(){o.action("text",{text:i.value,key:l})}function p(h){X[h?"unshift":"push"](()=>{i=h,t(2,i)})}const d=()=>o.preventExtension();return r.$$set=h=>{"key"in h&&t(0,l=h.key)},r.$$.update=()=>{r.$$.dirty&3&&(n[l],f())},[l,n,i,u,s,o,a,p,d]}class vr extends z{constructor(e){super(),U(this,e,wr,br,V,{key:0})}}function Cr(r){let e,t,n,l,s,o,i,u;return{c(){e=E("div"),t=E("input"),n=D(),l=E("input"),s=D(),o=E("input"),c(t,"type","text"),c(t,"placeholder","Month"),c(t,"class","svelte-fg214s"),H(t,"invalid",!r[3]),c(l,"type","text"),c(l,"placeholder","Date"),c(l,"class","svelte-fg214s"),H(l,"invalid",!r[4]),c(o,"type","text"),c(o,"placeholder","Year"),c(o,"class","svelte-fg214s"),H(o,"invalid",!r[5]),c(e,"class","top svelte-fg214s")},m(f,a){k(f,e,a),$(e,t),ue(t,r[0]),r[16](t),$(e,n),$(e,l),ue(l,r[1]),r[19](l),$(e,s),$(e,o),ue(o,r[2]),r[22](o),i||(u=[Z(t,"input",r[15]),Z(t,"keydown",r[11]),Z(t,"blur",r[17]),Z(l,"input",r[18]),Z(l,"keydown",r[12]),Z(l,"blur",r[20]),Z(o,"input",r[21]),Z(o,"blur",r[23])],i=!0)},p(f,[a]){a&1&&t.value!==f[0]&&ue(t,f[0]),a&8&&H(t,"invalid",!f[3]),a&2&&l.value!==f[1]&&ue(l,f[1]),a&16&&H(l,"invalid",!f[4]),a&4&&o.value!==f[2]&&ue(o,f[2]),a&32&&H(o,"invalid",!f[5])},i:C,o:C,d(f){f&&b(e),r[16](null),r[19](null),r[22](null),i=!1,pe(u)}}}function Ye(r){return r==null?r:r.replace(/\D/g,"")}function yr(r,e,t){let n,{key:l}=e;const s=ee("card");Q(r,s,q=>t(14,n=q));const o=ee("history");let i,u,f,a=n[l].month,p=n[l].day,d=n[l].year;function h(){o.action("editDate",{key:l,date:{month:a,day:p,year:d}})}function _(){t(0,a=Ye(a)),h()}function T(){t(1,p=Ye(p)),h()}function y(){t(2,d=Ye(d)),h()}function v(){let q=qe(n[l]);t(3,i=q.month),t(4,u=q.day),t(5,f=q.year),t(0,a=n[l].month),t(1,p=n[l].day),t(2,d=n[l].year)}let A,O,K;Ce(function(){A.focus()});function G(q){(q.key==="ArrowRight"||q.key==="Enter"||q.key==="/")&&(q.preventDefault(),O.focus())}function j(q){(q.key==="ArrowRight"||q.key==="Enter"||q.key==="/")&&(q.preventDefault(),K.focus())}function R(){a=this.value,t(0,a)}function B(q){X[q?"unshift":"push"](()=>{A=q,t(6,A)})}const N=()=>o.preventExtension();function fe(){p=this.value,t(1,p)}function ce(q){X[q?"unshift":"push"](()=>{O=q,t(7,O)})}const ie=()=>o.preventExtension();function be(){d=this.value,t(2,d)}function Ie(q){X[q?"unshift":"push"](()=>{K=q,t(8,K)})}const ae=()=>o.preventExtension();return r.$$set=q=>{"key"in q&&t(13,l=q.key)},r.$$.update=()=>{r.$$.dirty&1&&_(),r.$$.dirty&2&&T(),r.$$.dirty&4&&y(),r.$$.dirty&24576&&(n[l],v())},[a,p,d,i,u,f,A,O,K,s,o,G,j,l,n,R,B,N,fe,ce,ie,be,Ie,ae]}class Lr extends z{constructor(e){super(),U(this,e,yr,Cr,V,{key:13})}}function Ir(r){let e,t;return e=new x({props:{name:"organization"}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function Pr(r){let e,t;return e=new x({props:{name:"person"}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function Mr(r){let e,t,n,l;const s=[Pr,Ir],o=[];function i(u,f){return u[0].isPerson?0:1}return e=i(r),t=o[e]=s[e](r),{c(){t.c(),n=Ee()},m(u,f){o[e].m(u,f),k(u,n,f),l=!0},p(u,f){let a=e;e=i(u),e!==a&&(F(),m(o[a],1,1,()=>{o[a]=null}),Y(),t=o[e],t||(t=o[e]=s[e](u),t.c()),g(t,1),t.m(n.parentNode,n))},i(u){l||(g(t),l=!0)},o(u){m(t),l=!1},d(u){u&&b(n),o[e].d(u)}}}function Er(r){let e,t;return e=new x({props:{name:"delete"}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p:C,i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function Or(r){let e,t,n,l,s,o,i,u,f,a,p,d,h,_,T;return f=new re({props:{tooltip:r[0].isPerson?"Person":"Organization",$$slots:{default:[Mr]},$$scope:{ctx:r}}}),f.$on("click",r[11]),p=new re({props:{$$slots:{default:[Er]},$$scope:{ctx:r}}}),p.$on("click",r[4]),{c(){e=E("div"),t=E("input"),l=D(),s=E("div"),o=E("input"),u=D(),I(f.$$.fragment),a=D(),I(p.$$.fragment),c(t,"type","text"),t.value=n=r[0].name,c(t,"placeholder","name"),c(t,"class","svelte-1de26at"),c(o,"type","checkbox"),o.hidden=!0,o.value=i=r[0].isPerson,c(s,"class","right svelte-1de26at"),c(e,"class","top svelte-1de26at")},m(y,v){k(y,e,v),$(e,t),r[8](t),$(e,l),$(e,s),$(s,o),r[10](o),$(s,u),P(f,s,null),$(s,a),P(p,s,null),h=!0,_||(T=[Z(t,"input",r[5]),Z(t,"blur",r[9]),Z(o,"input",r[5])],_=!0)},p(y,[v]){(!h||v&1&&n!==(n=y[0].name)&&t.value!==n)&&(t.value=n),(!h||v&1&&i!==(i=y[0].isPerson))&&(o.value=i);const A={};v&1&&(A.tooltip=y[0].isPerson?"Person":"Organization"),v&4097&&(A.$$scope={dirty:v,ctx:y}),f.$set(A);const O={};v&4096&&(O.$$scope={dirty:v,ctx:y}),p.$set(O)},i(y){h||(g(f.$$.fragment,y),g(p.$$.fragment,y),y&&ge(()=>{h&&(d||(d=ne(e,r[6],{},!0)),d.run(1))}),h=!0)},o(y){m(f.$$.fragment,y),m(p.$$.fragment,y),y&&(d||(d=ne(e,r[6],{},!1)),d.run(0)),h=!1},d(y){y&&b(e),r[8](null),r[10](null),M(f),M(p),y&&d&&d.end(),_=!1,pe(T)}}}function Tr(r,e,t){let{author:n}=e,{index:l}=e;const s=ee("history");let o,i;Ce(function(){n.name==""&&o.focus()});function u(){s.action("deleteAuthor",{index:l})}function f(){s.action("editAuthor",{index:l,author:{name:o.value,isPerson:i.value,description:null,id:n.id}})}let a=he((T,y,v)=>`
      transform: scale(${y*100}%);
      height: ${y*v}px; 
    `,"sineOut",{preRun:T=>T.offsetHeight});function p(T){X[T?"unshift":"push"](()=>{o=T,t(1,o)})}const d=()=>s.preventExtension();function h(T){X[T?"unshift":"push"](()=>{i=T,t(2,i)})}const _=()=>t(0,n.isPerson=!n.isPerson,n);return r.$$set=T=>{"author"in T&&t(0,n=T.author),"index"in T&&t(7,l=T.index)},[n,o,i,s,u,f,a,l,p,d,h,_]}class Dr extends z{constructor(e){super(),U(this,e,Tr,Or,V,{author:0,index:7})}}function bt(r,e,t){const n=r.slice();return n[10]=e[t],n[11]=e,n[12]=t,n}function wt(r,e){let t,n,l,s;function o(u){e[6](u,e[10],e[11],e[12])}let i={index:e[12]};return e[10]!==void 0&&(i.author=e[10]),n=new Dr({props:i}),X.push(()=>Ge(n,"author",o)),{key:r,first:null,c(){t=E("li"),I(n.$$.fragment),this.first=t},m(u,f){k(u,t,f),P(n,t,null),s=!0},p(u,f){e=u;const a={};f&3&&(a.index=e[12]),!l&&f&3&&(l=!0,a.author=e[10],Je(()=>l=!1)),n.$set(a)},i(u){s||(g(n.$$.fragment,u),s=!0)},o(u){m(n.$$.fragment,u),s=!1},d(u){u&&b(t),M(n)}}}function Ar(r){let e;return{c(){e=J("Add author")},m(t,n){k(t,e,n)},d(t){t&&b(e)}}}function Hr(r){let e,t,n=[],l=new Map,s,o,i,u=de(r[1][r[0]]);const f=a=>a[10].id;for(let a=0;a<u.length;a+=1){let p=bt(r,u,a),d=f(p);l.set(d,n[a]=wt(d,p))}return o=new ve({props:{$$slots:{default:[Ar]},$$scope:{ctx:r}}}),o.$on("click",r[5]),{c(){e=E("div"),t=E("ul");for(let a=0;a<n.length;a+=1)n[a].c();s=D(),I(o.$$.fragment),c(t,"class","svelte-btldlk"),c(e,"class","top levelOne svelte-btldlk"),H(e,"invalid",!r[2])},m(a,p){k(a,e,p),$(e,t);for(let d=0;d<n.length;d+=1)n[d]&&n[d].m(t,null);$(t,s),P(o,t,null),r[7](e),i=!0},p(a,[p]){p&3&&(u=de(a[1][a[0]]),F(),n=Nt(n,p,f,1,a,u,l,t,zt,wt,s,bt),Y());const d={};p&8192&&(d.$$scope={dirty:p,ctx:a}),o.$set(d),(!i||p&4)&&H(e,"invalid",!a[2])},i(a){if(!i){for(let p=0;p<u.length;p+=1)g(n[p]);g(o.$$.fragment,a),i=!0}},o(a){for(let p=0;p<n.length;p+=1)m(n[p]);m(o.$$.fragment,a),i=!1},d(a){a&&b(e);for(let p=0;p<n.length;p+=1)n[p].d();M(o),r[7](null)}}}function Sr(r,e,t){let n,{key:l}=e;const s=ee("card");Q(r,s,h=>t(1,n=h));const o=ee("history");function i(){o.action("addAuthor",{}),setTimeout(function(){a.parentNode.scrollBy({top:a.parentNode.scrollHeight,behavior:"smooth"})},et)}let u;function f(){t(2,u=Dn(n[l]))}let a;function p(h,_,T,y){T[y]=h,s.set(n)}function d(h){X[h?"unshift":"push"](()=>{a=h,t(3,a)})}return r.$$set=h=>{"key"in h&&t(0,l=h.key)},r.$$.update=()=>{r.$$.dirty&3&&(n[l],f())},[l,n,u,a,s,i,p,d]}class Rr extends z{constructor(e){super(),U(this,e,Sr,Hr,V,{key:0})}}function Nr(r){let e,t,n,l,s=Qe[r[0]]+"",o,i,u,f,a,p,d,h;var _=r[1];function T(y,v){return{props:{key:y[0]}}}return _&&(f=je(_,T(r))),{c(){e=E("div"),t=E("div"),n=E("h1"),l=J("Edit "),o=J(s),i=D(),u=E("div"),f&&I(f.$$.fragment),c(n,"class","svelte-b0d6z9"),c(u,"class","content svelte-b0d6z9"),c(t,"class","top svelte-b0d6z9"),c(e,"class","center svelte-b0d6z9")},m(y,v){k(y,e,v),$(e,t),$(t,n),$(n,l),$(n,o),$(t,i),$(t,u),f&&P(f,u,null),p=!0,d||(h=[Rt(Kt.call(null,t)),Z(t,"outclick",r[4])],d=!0)},p(y,[v]){if((!p||v&1)&&s!==(s=Qe[y[0]]+"")&&ye(o,s),v&2&&_!==(_=y[1])){if(f){F();const A=f;m(A.$$.fragment,1,0,()=>{M(A,1)}),Y()}_?(f=je(_,T(y)),I(f.$$.fragment),g(f.$$.fragment,1),P(f,u,null)):f=null}else if(_){const A={};v&1&&(A.key=y[0]),f.$set(A)}},i(y){p||(f&&g(f.$$.fragment,y),y&&ge(()=>{p&&(a||(a=ne(t,r[3],{},!0)),a.run(1))}),p=!0)},o(y){f&&m(f.$$.fragment,y),y&&(a||(a=ne(t,r[3],{},!1)),a.run(0)),p=!1},d(y){y&&b(e),f&&M(f),y&&a&&a.end(),d=!1,pe(h)}}}function zr(r,e,t){let n,{key:l}=e,s=ee("currentEditor");Q(r,s,f=>t(5,n=f));let o=he((f,a)=>`
      transform: translateY(${(1-a)*100}%) scale(${a});
    `,"sineOut",{durationMultiplier:2}),i;function u(){oe(s,n=null,n)}return r.$$set=f=>{"key"in f&&t(0,l=f.key)},r.$$.update=()=>{r.$$.dirty&1&&(l=="authors"?t(1,i=Rr):l=="date"||l=="accessDate"?t(1,i=Lr):t(1,i=vr))},[l,i,s,o,u]}class Ur extends z{constructor(e){super(),U(this,e,zr,Nr,V,{key:0})}}function Vr(r){let e,t=r[0].text+"",n;return{c(){e=E("span"),n=J(t),c(e,"class","svelte-10oszq4"),H(e,"underline",r[0].underline),H(e,"highlight",r[0].highlight),H(e,"highlight-underline",r[0].underline&&r[0].highlight)},m(l,s){k(l,e,s),$(e,n)},p(l,[s]){s&1&&t!==(t=l[0].text+"")&&ye(n,t),s&1&&H(e,"underline",l[0].underline),s&1&&H(e,"highlight",l[0].highlight),s&1&&H(e,"highlight-underline",l[0].underline&&l[0].highlight)},i:C,o:C,d(l){l&&b(e)}}}function Zr(r,e,t){ee("currentTool");let{run:n}=e;return r.$$set=l=>{"run"in l&&t(0,n=l.run)},[n]}class qr extends z{constructor(e){super(),U(this,e,Zr,Vr,V,{run:0})}}function vt(r,e,t){const n=r.slice();return n[1]=e[t],n}function Ct(r){let e,t;return e=new qr({props:{run:r[1]}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p(n,l){const s={};l&1&&(s.run=n[1]),e.$set(s)},i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function Kr(r){let e,t,n=de(r[0]),l=[];for(let o=0;o<n.length;o+=1)l[o]=Ct(vt(r,n,o));const s=o=>m(l[o],1,1,()=>{l[o]=null});return{c(){e=E("p");for(let o=0;o<l.length;o+=1)l[o].c();c(e,"class","svelte-k4fhe6")},m(o,i){k(o,e,i);for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(e,null);t=!0},p(o,[i]){if(i&1){n=de(o[0]);let u;for(u=0;u<n.length;u+=1){const f=vt(o,n,u);l[u]?(l[u].p(f,i),g(l[u],1)):(l[u]=Ct(f),l[u].c(),g(l[u],1),l[u].m(e,null))}for(F(),u=n.length;u<l.length;u+=1)s(u);Y()}},i(o){if(!t){for(let i=0;i<n.length;i+=1)g(l[i]);t=!0}},o(o){l=l.filter(Boolean);for(let i=0;i<l.length;i+=1)m(l[i]);t=!1},d(o){o&&b(e),Xe(l,o)}}}function jr(r,e,t){let{runs:n}=e;return r.$$set=l=>{"runs"in l&&t(0,n=l.runs)},[n]}class Br extends z{constructor(e){super(),U(this,e,jr,Kr,V,{runs:0})}}function yt(r,e,t){const n=r.slice();return n[9]=e[t],n}function Lt(r){let e,t;return e=new Br({props:{runs:r[9]}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p(n,l){const s={};l&4&&(s.runs=n[9]),e.$set(s)},i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function Wr(r){let e,t,n=de(r[2].paras),l=[];for(let o=0;o<n.length;o+=1)l[o]=Lt(yt(r,n,o));const s=o=>m(l[o],1,1,()=>{l[o]=null});return{c(){e=E("article");for(let o=0;o<l.length;o+=1)l[o].c();H(e,"shrunk",r[0])},m(o,i){k(o,e,i);for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(e,null);r[5](e),t=!0},p(o,[i]){if(i&4){n=de(o[2].paras);let u;for(u=0;u<n.length;u+=1){const f=yt(o,n,u);l[u]?(l[u].p(f,i),g(l[u],1)):(l[u]=Lt(f),l[u].c(),g(l[u],1),l[u].m(e,null))}for(F(),u=n.length;u<l.length;u+=1)s(u);Y()}(!t||i&1)&&H(e,"shrunk",o[0])},i(o){if(!t){for(let i=0;i<n.length;i+=1)g(l[i]);t=!0}},o(o){l=l.filter(Boolean);for(let i=0;i<l.length;i+=1)m(l[i]);t=!1},d(o){o&&b(e),Xe(l,o),r[5](null)}}}function Be(r){if(r.nodeName==="SPAN")return r;if(r.nodeName==="P")return Be(r.firstChild);if(r.nodeName==="#text")return Be(r.parentNode);throw new Error("Unexpected node type")}function Fr(r,e,t){let n,l,{shrunk:s}=e,o=ee("currentTool");Q(r,o,d=>t(6,n=d));const i=ee("card");Q(r,i,d=>t(2,l=d));const u=ee("history");let f;function a(){if(n==null)return;const d=window.getSelection();if(d.rangeCount==0)return;const h=d.getRangeAt(0),_=h.startContainer,T=h.endContainer,y=h.startOffset,v=h.endOffset;if(!(f.contains(_)&&f.contains(T)))return;let A=Be(_),O=Be(T),K=A.parentElement,G=O.parentElement,j=Array.from(K.parentElement.children).indexOf(K),R=Array.from(G.parentElement.children).indexOf(G),B=Array.from(K.children).indexOf(A),N=Array.from(G.children).indexOf(O);j==R&&B==N&&y==v||(u.action("editPara",{tool:n,index:{startP:j,endP:R,startSpan:B,endSpan:N,startOffset:y,endOffset:v}}),d.empty())}Ce(function(){document.addEventListener("mouseup",a)});function p(d){X[d?"unshift":"push"](()=>{f=d,t(1,f)})}return r.$$set=d=>{"shrunk"in d&&t(0,s=d.shrunk)},[s,f,l,o,i,p]}class Yr extends z{constructor(e){super(),U(this,e,Fr,Wr,V,{shrunk:0})}}function Gr(r){let e,t;const n=r[3].default,l=He(n,r,r[2],null);return{c(){e=E("div"),l&&l.c(),c(e,"class","svelte-15ohuee"),H(e,"column",r[0]=="column"),H(e,"floating",r[1])},m(s,o){k(s,e,o),l&&l.m(e,null),t=!0},p(s,[o]){l&&l.p&&(!t||o&4)&&Se(l,n,s,s[2],t?Ne(n,s[2],o,null):Re(s[2]),null),(!t||o&1)&&H(e,"column",s[0]=="column"),(!t||o&2)&&H(e,"floating",s[1])},i(s){t||(g(l,s),t=!0)},o(s){m(l,s),t=!1},d(s){s&&b(e),l&&l.d(s)}}}function Jr(r,e,t){let{$$slots:n={},$$scope:l}=e,{direction:s="row"}=e,{floating:o=!1}=e;return r.$$set=i=>{"direction"in i&&t(0,s=i.direction),"floating"in i&&t(1,o=i.floating),"$$scope"in i&&t(2,l=i.$$scope)},[s,o,l,n]}class Me extends z{constructor(e){super(),U(this,e,Jr,Gr,V,{direction:0,floating:1})}}function Qr(r){let e,t;return e=new x({props:{name:"vault"}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p:C,i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function Xr(r){let e,t;return e=new re({props:{tooltip:r[2]?"Hide vault controls":"Show vault controls",selected:r[2],$$slots:{default:[Qr]},$$scope:{ctx:r}}}),e.$on("click",r[10]),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p(n,l){const s={};l&4&&(s.tooltip=n[2]?"Hide vault controls":"Show vault controls"),l&4&&(s.selected=n[2]),l&2097152&&(s.$$scope={dirty:l,ctx:n}),e.$set(s)},i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function xr(r){let e,t,n,l,s,o;return t=new Me({props:{floating:r[1],$$slots:{default:[rs]},$$scope:{ctx:r}}}),l=new Me({props:{floating:r[1],$$slots:{default:[os]},$$scope:{ctx:r}}}),{c(){e=E("div"),I(t.$$.fragment),n=D(),I(l.$$.fragment),c(e,"class","subbar svelte-mdpw2b")},m(i,u){k(i,e,u),P(t,e,null),$(e,n),P(l,e,null),o=!0},p(i,u){const f={};u&2&&(f.floating=i[1]),u&2097184&&(f.$$scope={dirty:u,ctx:i}),t.$set(f);const a={};u&2&&(a.floating=i[1]),u&2097153&&(a.$$scope={dirty:u,ctx:i}),l.$set(a)},i(i){o||(g(t.$$.fragment,i),g(l.$$.fragment,i),i&&ge(()=>{o&&(s||(s=ne(e,r[8],{},!0)),s.run(1))}),o=!0)},o(i){m(t.$$.fragment,i),m(l.$$.fragment,i),i&&(s||(s=ne(e,r[8],{},!1)),s.run(0)),o=!1},d(i){i&&b(e),M(t),M(l),i&&s&&s.end()}}}function es(r){let e,t,n,l,s,o;return t=new Me({props:{floating:r[1],$$slots:{default:[as]},$$scope:{ctx:r}}}),l=new Me({props:{$$slots:{default:[ds]},$$scope:{ctx:r}}}),{c(){e=E("div"),I(t.$$.fragment),n=D(),I(l.$$.fragment),c(e,"class","subbar svelte-mdpw2b")},m(i,u){k(i,e,u),P(t,e,null),$(e,n),P(l,e,null),o=!0},p(i,u){const f={};u&2&&(f.floating=i[1]),u&2097176&&(f.$$scope={dirty:u,ctx:i}),t.$set(f);const a={};u&2097176&&(a.$$scope={dirty:u,ctx:i}),l.$set(a)},i(i){o||(g(t.$$.fragment,i),g(l.$$.fragment,i),i&&ge(()=>{o&&(s||(s=ne(e,r[8],{},!0)),s.run(1))}),o=!0)},o(i){m(t.$$.fragment,i),m(l.$$.fragment,i),i&&(s||(s=ne(e,r[8],{},!1)),s.run(0)),o=!1},d(i){i&&b(e),M(t),M(l),i&&s&&s.end()}}}function ts(r){let e,t;return e=new x({props:{name:"underline"}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p:C,i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function ns(r){let e,t;return e=new x({props:{name:"highlight"}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p:C,i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function ls(r){let e,t;return e=new x({props:{name:"eraser"}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p:C,i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function rs(r){let e,t,n,l,s,o;return e=new re({props:{selected:r[5]=="underline",tooltip:"Underline",$$slots:{default:[ts]},$$scope:{ctx:r}}}),e.$on("click",r[15]),n=new re({props:{selected:r[5]=="highlight",tooltip:"Highlight",$$slots:{default:[ns]},$$scope:{ctx:r}}}),n.$on("click",r[16]),s=new re({props:{selected:r[5]=="eraser",tooltip:"Eraser",$$slots:{default:[ls]},$$scope:{ctx:r}}}),s.$on("click",r[17]),{c(){I(e.$$.fragment),t=D(),I(n.$$.fragment),l=D(),I(s.$$.fragment)},m(i,u){P(e,i,u),k(i,t,u),P(n,i,u),k(i,l,u),P(s,i,u),o=!0},p(i,u){const f={};u&32&&(f.selected=i[5]=="underline"),u&2097152&&(f.$$scope={dirty:u,ctx:i}),e.$set(f);const a={};u&32&&(a.selected=i[5]=="highlight"),u&2097152&&(a.$$scope={dirty:u,ctx:i}),n.$set(a);const p={};u&32&&(p.selected=i[5]=="eraser"),u&2097152&&(p.$$scope={dirty:u,ctx:i}),s.$set(p)},i(i){o||(g(e.$$.fragment,i),g(n.$$.fragment,i),g(s.$$.fragment,i),o=!0)},o(i){m(e.$$.fragment,i),m(n.$$.fragment,i),m(s.$$.fragment,i),o=!1},d(i){i&&(b(t),b(l)),M(e,i),M(n,i),M(s,i)}}}function ss(r){let e,t;return e=new x({props:{name:"shrink"}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p:C,i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function os(r){let e,t;return e=new re({props:{selected:r[0],tooltip:r[0]?"Expand text":"Shrink text",$$slots:{default:[ss]},$$scope:{ctx:r}}}),e.$on("click",r[18]),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p(n,l){const s={};l&1&&(s.selected=n[0]),l&1&&(s.tooltip=n[0]?"Expand text":"Shrink text"),l&2097152&&(s.$$scope={dirty:l,ctx:n}),e.$set(s)},i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function is(r){let e,t;return e=new x({props:{name:"login"}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p:C,i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function us(r){let e,t;return e=new x({props:{name:"person"}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p:C,i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function as(r){let e,t,n,l;return e=new re({props:{tooltip:r[3].loggedIn?"Log out":"Log in",selected:!r[3].loggedIn,selectedColor:!1,$$slots:{default:[is]},$$scope:{ctx:r}}}),e.$on("click",r[11]),n=new re({props:{tooltip:"Account",disabled:!r[3].loggedIn,$$slots:{default:[us]},$$scope:{ctx:r}}}),n.$on("click",r[12]),{c(){I(e.$$.fragment),t=D(),I(n.$$.fragment)},m(s,o){P(e,s,o),k(s,t,o),P(n,s,o),l=!0},p(s,o){const i={};o&8&&(i.tooltip=s[3].loggedIn?"Log out":"Log in"),o&8&&(i.selected=!s[3].loggedIn),o&2097152&&(i.$$scope={dirty:o,ctx:s}),e.$set(i);const u={};o&8&&(u.disabled=!s[3].loggedIn),o&2097152&&(u.$$scope={dirty:o,ctx:s}),n.$set(u)},i(s){l||(g(e.$$.fragment,s),g(n.$$.fragment,s),l=!0)},o(s){m(e.$$.fragment,s),m(n.$$.fragment,s),l=!1},d(s){s&&b(t),M(e,s),M(n,s)}}}function fs(r){let e,t;return e=new x({props:{name:"upload"}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p:C,i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function cs(r){let e,t;return e=new x({props:{name:"robot"}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p:C,i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function ds(r){let e,t,n,l;return e=new re({props:{tooltip:"Upload to arguflow",disabled:!r[3].loggedIn,$$slots:{default:[fs]},$$scope:{ctx:r}}}),e.$on("click",r[13]),n=new re({props:{tooltip:"Auto cut",disabled:!r[3].loggedIn,$$slots:{default:[cs]},$$scope:{ctx:r}}}),n.$on("click",r[14]),{c(){I(e.$$.fragment),t=D(),I(n.$$.fragment)},m(s,o){P(e,s,o),k(s,t,o),P(n,s,o),l=!0},p(s,o){const i={};o&8&&(i.disabled=!s[3].loggedIn),o&2097152&&(i.$$scope={dirty:o,ctx:s}),e.$set(i);const u={};o&8&&(u.disabled=!s[3].loggedIn),o&2097152&&(u.$$scope={dirty:o,ctx:s}),n.$set(u)},i(s){l||(g(e.$$.fragment,s),g(n.$$.fragment,s),l=!0)},o(s){m(e.$$.fragment,s),m(n.$$.fragment,s),l=!1},d(s){s&&b(t),M(e,s),M(n,s)}}}function ps(r){let e,t,n,l,s,o;t=new Me({props:{floating:r[1],$$slots:{default:[Xr]},$$scope:{ctx:r}}});const i=[es,xr],u=[];function f(a,p){return a[2]?0:1}return l=f(r),s=u[l]=i[l](r),{c(){e=E("div"),I(t.$$.fragment),n=D(),s.c(),c(e,"class","toolbar levelOne svelte-mdpw2b")},m(a,p){k(a,e,p),P(t,e,null),$(e,n),u[l].m(e,null),o=!0},p(a,[p]){const d={};p&2&&(d.floating=a[1]),p&2097156&&(d.$$scope={dirty:p,ctx:a}),t.$set(d);let h=l;l=f(a),l===h?u[l].p(a,p):(F(),m(u[h],1,1,()=>{u[h]=null}),Y(),s=u[l],s?s.p(a,p):(s=u[l]=i[l](a),s.c()),g(s,1),s.m(e,null))},i(a){o||(g(t.$$.fragment,a),g(s),o=!0)},o(a){m(t.$$.fragment,a),m(s),o=!1},d(a){a&&b(e),M(t),u[l].d()}}}function hs(r,e,t){let n,l,s;Q(r,Oe,R=>t(3,n=R)),Q(r,Pe,R=>t(4,l=R));let o=ee("currentTool");Q(r,o,R=>t(5,s=R));const i=ee("history");let{floating:u}=e,{shrunk:f}=e;function a(){let R="";for(let B of d)for(let N of B)R+=N.text;if(R.length==0){W.addErrorMessage("No text");return}if(R.length>=4300){W.addErrorMessage(`Too much text, ${R.length}/4300 characters`);return}if(R.length<=200){W.addErrorMessage(`Too little text ${R.length}/200 characters`);return}W.addMessage("Auto cutting..."),Jn(R).then(B=>{W.addMessage("Done!"),i.action("autoCutParas",Xn(B.completion))}).catch(B=>{W.addError("auto cut",B)})}let p=he((R,B)=>`
      transform: scale(${B});
      transform-origin: 0% 50%;
    `,"sineOut",{durationMultiplier:2}),{paras:d}=e,h=!1;const _=()=>t(2,h=!h),T=()=>{n.loggedIn?Gn().then(()=>{W.addMessage("Logged out")}).catch(R=>{W.addError("logout",R)}):(l.push("login"),Pe.set(l))},y=()=>{Qn().then(R=>{window.open(Kn+R,"_blank")}).catch(R=>{W.addError("user info",R)})},v=()=>{l.push("upload"),Pe.set(l)},A=()=>{a()},O=()=>oe(o,s="underline",s),K=()=>oe(o,s="highlight",s),G=()=>oe(o,s="eraser",s),j=()=>t(0,f=!f);return r.$$set=R=>{"floating"in R&&t(1,u=R.floating),"shrunk"in R&&t(0,f=R.shrunk),"paras"in R&&t(9,d=R.paras)},[f,u,h,n,l,s,o,a,p,d,_,T,y,v,A,O,K,G,j]}class gs extends z{constructor(e){super(),U(this,e,hs,ps,V,{floating:1,shrunk:0,paras:9})}}function ms(r){let e,t,n,l;return{c(){e=E("div"),t=J(r[0]),c(e,"class","message svelte-1ivoti1"),H(e,"error",r[1])},m(s,o){k(s,e,o),$(e,t),l=!0},p(s,[o]){(!l||o&1)&&ye(t,s[0]),(!l||o&2)&&H(e,"error",s[1])},i(s){l||(s&&ge(()=>{l&&(n||(n=ne(e,r[2],{},!0)),n.run(1))}),l=!0)},o(s){s&&(n||(n=ne(e,r[2],{},!1)),n.run(0)),l=!1},d(s){s&&b(e),s&&n&&n.end()}}}function _s(r,e,t){let{text:n}=e,{error:l}=e,s=he((o,i,u)=>`
        transform: scale(${i});
        height: ${i*u}px;
        padding: calc(var(--padding-small) * ${i}) calc(var(--padding) * ${i}); 
      `,"sineOut",{preRun:o=>o.getBoundingClientRect().height});return r.$$set=o=>{"text"in o&&t(0,n=o.text),"error"in o&&t(1,l=o.error)},[n,l,s]}class $s extends z{constructor(e){super(),U(this,e,_s,ms,V,{text:0,error:1})}}function It(r,e,t){const n=r.slice();return n[5]=e[t],n}function Pt(r){let e,t,n,l;const s=[bs,ks],o=[];function i(u,f){return u[0]?1:0}return e=i(r),t=o[e]=s[e](r),{c(){t.c(),n=Ee()},m(u,f){o[e].m(u,f),k(u,n,f),l=!0},p(u,f){let a=e;e=i(u),e===a?o[e].p(u,f):(F(),m(o[a],1,1,()=>{o[a]=null}),Y(),t=o[e],t?t.p(u,f):(t=o[e]=s[e](u),t.c()),g(t,1),t.m(n.parentNode,n))},i(u){l||(g(t),l=!0)},o(u){m(t),l=!1},d(u){u&&b(n),o[e].d(u)}}}function ks(r){let e,t,n;return{c(){e=E("div"),c(e,"class","mini svelte-rb0mdd")},m(l,s){k(l,e,s),n=!0},p:C,i(l){n||(l&&ge(()=>{n&&(t||(t=ne(e,r[3],{},!0)),t.run(1))}),n=!0)},o(l){l&&(t||(t=ne(e,r[3],{},!1)),t.run(0)),n=!1},d(l){l&&b(e),l&&t&&t.end()}}}function bs(r){let e,t=[],n=new Map,l,s,o=de(r[1]);const i=u=>u[5].id;for(let u=0;u<o.length;u+=1){let f=It(r,o,u),a=i(f);n.set(a,t[u]=Mt(a,f))}return{c(){e=E("ul");for(let u=0;u<t.length;u+=1)t[u].c();c(e,"class","svelte-rb0mdd")},m(u,f){k(u,e,f);for(let a=0;a<t.length;a+=1)t[a]&&t[a].m(e,null);s=!0},p(u,f){f&2&&(o=de(u[1]),F(),t=Nt(t,f,i,1,u,o,n,e,zt,Mt,null,It),Y())},i(u){if(!s){for(let f=0;f<o.length;f+=1)g(t[f]);u&&ge(()=>{s&&(l||(l=ne(e,r[2],{},!0)),l.run(1))}),s=!0}},o(u){for(let f=0;f<t.length;f+=1)m(t[f]);u&&(l||(l=ne(e,r[2],{},!1)),l.run(0)),s=!1},d(u){u&&b(e);for(let f=0;f<t.length;f+=1)t[f].d();u&&l&&l.end()}}}function Mt(r,e){let t,n,l;const s=[e[5]];let o={};for(let i=0;i<s.length;i+=1)o=At(o,s[i]);return n=new $s({props:o}),{key:r,first:null,c(){t=Ee(),I(n.$$.fragment),this.first=t},m(i,u){k(i,t,u),P(n,i,u),l=!0},p(i,u){e=i;const f=u&2?Ht(s,[St(e[5])]):{};n.$set(f)},i(i){l||(g(n.$$.fragment,i),l=!0)},o(i){m(n.$$.fragment,i),l=!1},d(i){i&&b(t),M(n,i)}}}function ws(r){let e,t,n,l,s=r[1].length>0&&Pt(r);return{c(){e=E("div"),s&&s.c(),c(e,"class","top svelte-rb0mdd"),H(e,"minimized",r[0])},m(o,i){k(o,e,i),s&&s.m(e,null),t=!0,n||(l=Z(e,"click",r[4]),n=!0)},p(o,[i]){o[1].length>0?s?(s.p(o,i),i&2&&g(s,1)):(s=Pt(o),s.c(),g(s,1),s.m(e,null)):s&&(F(),m(s,1,1,()=>{s=null}),Y()),(!t||i&1)&&H(e,"minimized",o[0])},i(o){t||(g(s),t=!0)},o(o){m(s),t=!1},d(o){o&&b(e),s&&s.d(),n=!1,l()}}}function vs(r,e,t){let n;Q(r,Rn,u=>t(1,n=u));let l=!1,s=he((u,f)=>`
      transform: scale(${f});
    `,"sineIn"),o=he((u,f)=>`
      transform: scale(${f});
    `,"sineOut");return[l,n,s,o,()=>t(0,l=!l)]}class Cs extends z{constructor(e){super(),U(this,e,vs,ws,V,{})}}const{window:ys}=On;function Et(r){let e,t;return e=new re({props:{tooltip:"Popout",$$slots:{default:[Ls]},$$scope:{ctx:r}}}),e.$on("click",As),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p(n,l){const s={};l&1073741824&&(s.$$scope={dirty:l,ctx:n}),e.$set(s)},i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function Ls(r){let e,t;return e=new x({props:{name:"popout"}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p:C,i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function Is(r){let e,t;return e=new x({props:{name:"copy"}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p:C,i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function Ps(r){let e,t;return e=new x({props:{name:"reload"}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p:C,i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function Ms(r){let e,t,n,l,s,o=r[0]=="popup"&&Et(r);return t=new re({props:{tooltip:"Copy card",$$slots:{default:[Is]},$$scope:{ctx:r}}}),t.$on("click",r[17]),l=new re({props:{tooltip:"Reset card",$$slots:{default:[Ps]},$$scope:{ctx:r}}}),l.$on("click",r[16]),{c(){o&&o.c(),e=D(),I(t.$$.fragment),n=D(),I(l.$$.fragment)},m(i,u){o&&o.m(i,u),k(i,e,u),P(t,i,u),k(i,n,u),P(l,i,u),s=!0},p(i,u){i[0]=="popup"?o?(o.p(i,u),u&1&&g(o,1)):(o=Et(i),o.c(),g(o,1),o.m(e.parentNode,e)):o&&(F(),m(o,1,1,()=>{o=null}),Y());const f={};u&1073741824&&(f.$$scope={dirty:u,ctx:i}),t.$set(f);const a={};u&1073741824&&(a.$$scope={dirty:u,ctx:i}),l.$set(a)},i(i){s||(g(o),g(t.$$.fragment,i),g(l.$$.fragment,i),s=!0)},o(i){m(o),m(t.$$.fragment,i),m(l.$$.fragment,i),s=!1},d(i){i&&(b(e),b(n)),o&&o.d(i),M(t,i),M(l,i)}}}function Ot(r){let e,t,n,l,s,o,i,u,f,a,p,d,h,_,T,y,v,A,O,K,G,j,R,B,N,fe,ce,ie,be,Ie,ae,q,w,te,me,Te,We,tt;function jt(S){r[19](S)}let nt={placeholder:"Type a one sentence summary..."};r[7].tag!==void 0&&(nt.text=r[7].tag),n=new Zn({props:nt}),r[18](n),X.push(()=>Ge(n,"text",jt)),u=new we({props:{formatter:le.bigAuthors}}),a=new we({props:{formatter:le.bigDate}}),_=new we({props:{formatter:le.authors}}),y=new we({props:{formatter:le.title}}),O=new we({props:{formatter:le.siteName}}),j=new we({props:{formatter:le.date}}),B=new we({props:{formatter:le.url}});let lt=Ds;function Bt(S){r[21](S)}let rt={paras:r[7].paras,floating:r[4]};r[6]!==void 0&&(rt.shrunk=r[6]),ie=new gs({props:rt}),X.push(()=>Ge(ie,"shrunk",Bt)),ae=new Yr({props:{shrunk:r[6]}});const st=[Os,Es],_e=[];function ot(S,se){return S[8].length>0?0:S[9]!=null?1:-1}return~(w=ot(r))&&(te=_e[w]=st[w](r)),{c(){e=E("div"),t=E("div"),I(n.$$.fragment),s=D(),o=E("div"),i=E("span"),I(u.$$.fragment),f=D(),I(a.$$.fragment),p=D(),d=E("br"),h=D(),I(_.$$.fragment),T=J(`.\r
         "`),I(y.$$.fragment),v=J('." '),A=E("i"),I(O.$$.fragment),K=J(","),G=D(),I(j.$$.fragment),R=J(", "),I(B.$$.fragment),N=J(`. \r
        `),fe=D(),ce=E("div"),I(ie.$$.fragment),Ie=D(),I(ae.$$.fragment),q=D(),te&&te.c(),me=Ee(),c(t,"class","tag svelte-1hsdvli"),H(t,"moreWidth",r[0]!="popup"),c(i,"class","bigCite svelte-1hsdvli"),c(o,"class","cite svelte-1hsdvli"),c(ce,"class","paras svelte-1hsdvli"),c(e,"class","card svelte-1hsdvli")},m(S,se){k(S,e,se),$(e,t),P(n,t,null),$(e,s),$(e,o),$(o,i),P(u,i,null),$(i,f),P(a,i,null),$(o,p),$(o,d),$(o,h),P(_,o,null),$(o,T),P(y,o,null),$(o,v),$(o,A),P(O,A,null),$(A,K),$(o,G),P(j,o,null),$(o,R),P(B,o,null),$(o,N),r[20](o),$(e,fe),$(e,ce),P(ie,ce,null),$(ce,Ie),P(ae,ce,null),r[22](e),k(S,q,se),~w&&_e[w].m(S,se),k(S,me,se),Te=!0,We||(tt=Z(e,"scroll",r[14]),We=!0)},p(S,se){const it={};!l&&se&128&&(l=!0,it.text=S[7].tag,Je(()=>l=!1)),n.$set(it),(!Te||se&1)&&H(t,"moreWidth",S[0]!="popup");const Ue={};se&128&&(Ue.paras=S[7].paras),se&16&&(Ue.floating=S[4]),!be&&se&64&&(be=!0,Ue.shrunk=S[6],Je(()=>be=!1)),ie.$set(Ue);const ut={};se&64&&(ut.shrunk=S[6]),ae.$set(ut);let Fe=w;w=ot(S),w===Fe?~w&&_e[w].p(S,se):(te&&(F(),m(_e[Fe],1,1,()=>{_e[Fe]=null}),Y()),~w?(te=_e[w],te?te.p(S,se):(te=_e[w]=st[w](S),te.c()),g(te,1),te.m(me.parentNode,me)):te=null)},i(S){Te||(g(n.$$.fragment,S),g(u.$$.fragment,S),g(a.$$.fragment,S),g(_.$$.fragment,S),g(y.$$.fragment,S),g(O.$$.fragment,S),g(j.$$.fragment,S),g(B.$$.fragment,S),g(lt),g(ie.$$.fragment,S),g(ae.$$.fragment,S),g(te),Te=!0)},o(S){m(n.$$.fragment,S),m(u.$$.fragment,S),m(a.$$.fragment,S),m(_.$$.fragment,S),m(y.$$.fragment,S),m(O.$$.fragment,S),m(j.$$.fragment,S),m(B.$$.fragment,S),m(lt),m(ie.$$.fragment,S),m(ae.$$.fragment,S),m(te),Te=!1},d(S){S&&(b(e),b(q),b(me)),r[18](null),M(n),M(u),M(a),M(_),M(y),M(O),M(j),M(B),r[20](null),M(ie),M(ae),r[22](null),~w&&_e[w].d(S),We=!1,tt()}}}function Es(r){let e,t;return e=new Ur({props:{key:r[9]}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p(n,l){const s={};l&512&&(s.key=n[9]),e.$set(s)},i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function Os(r){let e,t;return e=new _r({props:{name:r[8][0],closePopup:r[23]}}),{c(){I(e.$$.fragment)},m(n,l){P(e,n,l),t=!0},p(n,l){const s={};l&256&&(s.name=n[8][0]),l&256&&(s.closePopup=n[23]),e.$set(s)},i(n){t||(g(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function Ts(r){let e,t,n,l,s,o,i,u,f;t=new Cs({}),s=new Me({props:{floating:r[3],$$slots:{default:[Ms]},$$scope:{ctx:r}}});let a=r[7]&&Ot(r);return{c(){e=E("div"),I(t.$$.fragment),n=D(),l=E("div"),I(s.$$.fragment),o=D(),a&&a.c(),c(l,"class","buttons levelOne svelte-1hsdvli"),c(e,"class","container svelte-1hsdvli"),H(e,"fixedWidth",r[0]=="popup")},m(p,d){k(p,e,d),P(t,e,null),$(e,n),$(e,l),P(s,l,null),$(e,o),a&&a.m(e,null),i=!0,u||(f=Z(ys,"keydown",r[15]),u=!0)},p(p,[d]){const h={};d&8&&(h.floating=p[3]),d&1073741825&&(h.$$scope={dirty:d,ctx:p}),s.$set(h),p[7]?a?(a.p(p,d),d&128&&g(a,1)):(a=Ot(p),a.c(),g(a,1),a.m(e,null)):a&&(F(),m(a,1,1,()=>{a=null}),Y()),(!i||d&1)&&H(e,"fixedWidth",p[0]=="popup")},i(p){i||(g(t.$$.fragment,p),g(s.$$.fragment,p),g(a),i=!0)},o(p){m(t.$$.fragment,p),m(s.$$.fragment,p),m(a),i=!1},d(p){p&&b(e),M(t),M(s),a&&a.d(),u=!1,f()}}}let Ds=!1;function Tt(){return new Promise((r,e)=>{chrome.runtime.sendMessage({message:"getCardData"},function(t){r(t.card)})})}async function As(){let e=(await chrome.system.display.getInfo())[0].bounds.width;chrome.windows.create({url:chrome.runtime.getURL("src/pages/options/index.html"),type:"popup",width:600,height:800,left:e-600,top:0}),window.close()}function Hs(r,e,t){let n,l,s,o,i;Q(r,Pe,w=>t(8,o=w));let{context:u}=e,f=ke(null);Q(r,f,w=>t(24,s=w)),De("currentTool",f);let a=ke(null);Q(r,a,w=>t(9,i=w)),De("currentEditor",a);let p=ke(!1);Q(r,p,w=>t(6,n=w)),De("shrunk",p);let d=ke(null);Q(r,d,w=>t(7,l=w)),De("card",d);let h=new zn(d);De("history",h);let _,T=!1,y=!1;function v(){t(3,T=_.scrollTop>0)}let A,O=new IntersectionObserver(w=>{w[0].intersectionRatio==0?t(4,y=!0):t(4,y=!1)},{threshold:[0],root:_});function K(){O.disconnect(),A!=null&&O.observe(A)}let G=window.matchMedia("(prefers-color-scheme: dark)"),j=function(){document.body.classList.toggle("dark",G.matches)};j(),G.addEventListener("change",j);let R;Ce(function(){Tt().then(w=>{d.set(w)})});function B(w){w.key=="z"&&(w.metaKey||w.ctrlKey)&&w.shiftKey?(w.preventDefault(),w.stopPropagation(),h.redo()):w.key=="z"&&(w.metaKey||w.ctrlKey)&&(w.preventDefault(),w.stopPropagation(),h.undo()),!(w.target instanceof HTMLTextAreaElement||w.target instanceof HTMLInputElement)&&(w.key=="c"&&(w.metaKey||w.ctrlKey)&&(w.preventDefault(),w.stopPropagation(),chrome.tabs.create({url:chrome.runtime.getURL("src/pages/sidepanel/index.html")})),w.key=="p"&&!(w.metaKey||w.ctrlKey||w.shiftKey)&&(w.preventDefault(),w.stopPropagation(),oe(f,s=null,s)),w.key=="h"&&!(w.metaKey||w.ctrlKey||w.shiftKey)?(w.preventDefault(),w.stopPropagation(),oe(f,s="highlight",s)):w.key=="u"&&!(w.metaKey||w.ctrlKey||w.shiftKey)?(w.preventDefault(),w.stopPropagation(),oe(f,s="underline",s)):w.key=="e"&&!(w.metaKey||w.ctrlKey||w.shiftKey)&&(w.preventDefault(),w.stopPropagation(),oe(f,s="eraser",s)))}async function N(){let w=new Promise((te,me)=>{setTimeout(te,et*2)});_.offsetWidth,Promise.all([w,Tt()]).then(([te,me])=>{d.set(me),t(2,_.scrollTop=0,_),_.offsetWidth})}function fe(){An(l,n),W.addMessage("Copied to clipboard!")}function ce(w){X[w?"unshift":"push"](()=>{R=w,t(5,R)})}function ie(w){r.$$.not_equal(l.tag,w)&&(l.tag=w,d.set(l))}function be(w){X[w?"unshift":"push"](()=>{A=w,t(1,A)})}function Ie(w){n=w,p.set(n)}function ae(w){X[w?"unshift":"push"](()=>{_=w,t(2,_)})}const q=()=>{oe(Pe,o=o.slice(1),o),Pe.set(o)};return r.$$set=w=>{"context"in w&&t(0,u=w.context)},r.$$.update=()=>{r.$$.dirty&2&&K()},[u,A,_,T,y,R,n,l,o,i,f,a,p,d,v,B,N,fe,ce,ie,be,Ie,ae,q]}class Ss extends z{constructor(e){super(),U(this,e,Hs,Ts,V,{context:0})}}function Rs(){new Ss({target:document.body})}document.addEventListener("DOMContentLoaded",Rs);
